{"version":3,"sources":["context/notification-context.js","components/IconButton/index.js","components/Input/index.js","components/InfoBar/index.js","components/Message/index.js","components/Messages/index.js","util/FileConverter.js","components/Chat/index.js","util/FileProcessor.js","components/Box/index.js","util/auth.js","components/Join/index.js","components/Login/index.js","components/Signup/index.js","components/Home/index.js","components/Head/index.js","components/PrivateRoute/index.js","components/AuthButton/index.js","App.js","index.js"],"names":["NotificationContext","createContext","NotificationContextProvider","props","useState","notification","setNotification","Provider","value","children","IconButton","onHandleClick","className","name","disabled","icon","iconName","htmlFor","type","id","accept","onChange","e","files","Array","from","target","formData","FormData","append","get","Input","message","setMessage","sendMessage","sendFile","uploadFile","console","log","placeholder","event","onKeyPress","key","size","onClick","color","React","memo","room","counts","to","Message","user","content","upload","address","percent","date","avatarSrc","isSentByCurrentUser","trimmedName","trim","toLowerCase","role","title","src","roundedCircle","ProgressBar","now","animated","renderProgress","moment","format","dangerouslySetInnerHTML","__html","width","controls","renderFile","ReactEmoji","emojify","messages","rest","map","dataURLtoFile","base64","config","callback","arr","split","mime","match","bstr","atob","n","length","u8arr","Uint8Array","charCodeAt","File","socket","FileProcessor","file","this","stream","ss","createStream","createBlobReadStream","pipe","emit","quality","convertToDataUrl","then","readerDataUrl","Promise","resolve","alert","data","a","addImageProcess","reject","reader","FileReader","readAsDataURL","onload","result","onerror","onloadend","Chat","search","useLocation","setName","setRoom","setMessages","setCounts","ENDPOINT","useEffect","qs","parse","io","path","transports","secure","error","off","getMessage","element","on","amount","messageIndex","findIndex","addMessage","index","payload","updateMessage","users","preventDefault","process","minifiedFileProcessor","send","originalFileProcessor","Box","control","defaultProps","setHasNotification","hasNotification","API_URL","Join","avatar","setAvatar","Form","URL","createObjectURL","Group","controlId","Label","Control","Button","block","username","password","axios","post","response","accessToken","localStorage","setItem","JSON","stringify","removeItem","email","roles","getItem","Login","useContext","redirectToReferrer","setRedirectToReferrer","setUsername","setPassword","AuthService","login","catch","status","setTimeout","variant","Signup","setEmail","hasSignup","setHasSignup","signup","Home","getCurrentUser","Head","PrivateRoute","Component","component","render","pathname","state","location","AuthButton","withRouter","history","logout","push","App","exact","ReactDom","document","querySelector"],"mappings":"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","file":"static/js/main.df1ee45a.chunk.js","sourcesContent":["import React, { useState, createContext } from 'react';\r\n\r\n// Create Context Object\r\nexport const NotificationContext = createContext();\r\n\r\n// Create a provider for components to consume and subscribe to changes\r\nexport const NotificationContextProvider = (props) => {\r\n  const [notification, setNotification] = useState({});\r\n\r\n  return (\r\n    <NotificationContext.Provider value={[notification, setNotification]}>\r\n      {props.children}\r\n    </NotificationContext.Provider>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport './index.scss';\r\n\r\n//USER送發訊息的人，name該聊天室使用者名字\r\nconst IconButton = ({ onHandleClick, className, name, disabled, icon }) => {\r\n  const onChange = (e) => {\r\n    const files = Array.from(e.target.files);\r\n    let formData = new FormData();\r\n    formData.append(0, files[0]);\r\n    onHandleClick(formData.get(0));\r\n  };\r\n  const iconName = `icon-${name}`;\r\n  return (\r\n    <span className={`chat__icon ${className} ${disabled ? 'disabled' : ''}`}>\r\n      <label className=\"chat__label\" htmlFor={iconName}>\r\n        {icon && icon}\r\n      </label>\r\n      <input\r\n        className=\"hidden-input\"\r\n        type=\"file\"\r\n        name={iconName}\r\n        id={iconName}\r\n        accept=\"image/*,video/*,audio/*\"\r\n        onChange={onChange}\r\n      />\r\n    </span>\r\n  );\r\n};\r\n\r\nexport default IconButton;\r\n","import React from 'react';\r\n// import { Row, Col, Button } from 'react-bootstrap';\r\nimport { ChatTextFill, CloudUploadFill, Image } from 'react-bootstrap-icons';\r\nimport IconButton from '../IconButton';\r\nimport './index.scss';\r\n\r\nconst Input = ({\r\n  message = '',\r\n  setMessage,\r\n  sendMessage,\r\n  sendFile,\r\n  uploadFile,\r\n}) => {\r\n  const handleSendMessage = (event) => {\r\n    sendMessage(event);\r\n  };\r\n  console.log('信息', message);\r\n  return (\r\n    <form className=\"chat__form\">\r\n      <textarea\r\n        className=\"chat__message\"\r\n        placeholder=\"write some message...\"\r\n        value={message}\r\n        onChange={(event) => setMessage(event.target.value)}\r\n        onKeyPress={(event) =>\r\n          event.key === 'Enter' ? setMessage(event.target.value) : null\r\n        }\r\n      />\r\n      <div className=\"chat__controls\">\r\n        <IconButton\r\n          disabled={message}\r\n          className=\"chat__flex\"\r\n          type=\"file\"\r\n          onHandleClick={sendFile}\r\n          icon={<Image />}\r\n          name=\"files\"\r\n        />\r\n        <IconButton\r\n          disabled={message}\r\n          className=\"chat__flex\"\r\n          type=\"file\"\r\n          onHandleClick={uploadFile}\r\n          icon={<CloudUploadFill />}\r\n          name=\"upload\"\r\n        />\r\n        <ChatTextFill\r\n          className=\"chat__flex\"\r\n          size=\"32\"\r\n          onClick={message ? handleSendMessage : null}\r\n          color={message ? 'darkslategray' : '#e3e3e3'}\r\n        />\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\nexport default Input;\r\n","import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\n// import { Row, Col } from 'react-bootstrap';\r\nimport { ArrowLeftCircle, PeopleFill } from 'react-bootstrap-icons';\r\nimport './index.scss';\r\n\r\nconst InfoBar = ({ room, counts }) => (\r\n  <div className=\"chat__infoBar\">\r\n    <div className=\"chat__room\">\r\n      <h3>{room}</h3>\r\n    </div>\r\n    <div className=\"chat__count\">\r\n      {counts} <PeopleFill color=\"#ffffff\" size={24} />\r\n    </div>\r\n    <div className=\"chat__back\">\r\n      <Link to=\"/\">\r\n        <ArrowLeftCircle color=\"white\" size={24} />\r\n      </Link>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default React.memo(InfoBar);\r\n","import React from 'react';\r\nimport { Image, ProgressBar } from 'react-bootstrap';\r\nimport { PersonCircle } from 'react-bootstrap-icons';\r\nimport ReactEmoji from 'react-emoji';\r\nimport moment from 'moment';\r\nimport './index.scss';\r\n\r\n//USER送發訊息的人，name該聊天室使用者名字\r\nconst Message = ({\r\n  message,\r\n  message: { user, content, upload, type, address, percent, date },\r\n  name,\r\n  avatarSrc,\r\n}) => {\r\n  // console.log('最後', user, content, message);\r\n  let isSentByCurrentUser = false;\r\n  const trimmedName = name.trim().toLowerCase();\r\n  if (trimmedName === user) isSentByCurrentUser = true;\r\n  const role = isSentByCurrentUser ? 'user' : 'friend';\r\n  const title = role === 'user' ? trimmedName : user;\r\n  const renderProgress = (percent) => {\r\n    if (percent > 0 && percent < 100)\r\n      return (\r\n        <>\r\n          loading...\r\n          <ProgressBar now={percent} animated />\r\n        </>\r\n      );\r\n  };\r\n\r\n  const renderFile = ({ address, type, upload }) => {\r\n    if (address) return <div dangerouslySetInnerHTML={{ __html: address }} />;\r\n    if (type && upload) {\r\n      switch (type) {\r\n        case 'video/mp4': {\r\n          return (\r\n            <video width=\"100%\" controls>\r\n              <source\r\n                src={`data:image/png;base64, ${upload}`}\r\n                type=\"video/mp4\"\r\n              />\r\n              <source\r\n                src={`data:image/png;base64, ${upload}`}\r\n                type=\"video/ogg\"\r\n              />\r\n              Your browser does not support the video tag.\r\n            </video>\r\n          );\r\n          break;\r\n        }\r\n        case 'image/*':\r\n          return (\r\n            <img\r\n              className=\"img-thumbnail img-fluid\"\r\n              src={`data:image/png;base64, ${upload}`}\r\n            />\r\n          );\r\n          break;\r\n        default:\r\n          return (\r\n            <img\r\n              className=\"img-thumbnail img-fluid\"\r\n              src={`data:image/png;base64, ${upload}`}\r\n            />\r\n          );\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={`chat-message chat-message--${role}`}>\r\n      {role === 'friend' && (\r\n        <h4>\r\n          {avatarSrc ? (\r\n            <Image src={avatarSrc} roundedCircle />\r\n          ) : (\r\n            <PersonCircle size={24} />\r\n          )}\r\n          <span>{title}</span>\r\n        </h4>\r\n      )}\r\n      <div className=\"chat-message__body\">\r\n        {renderProgress(percent)}\r\n        <span className=\"chat-message__date\">{moment(date).format('LTS')}</span>\r\n        {renderFile({ address, percent, type, upload })}\r\n        {content && (\r\n          <p className=\"chat-message__body--text\">\r\n            {ReactEmoji.emojify(content)}\r\n          </p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Message;\r\n","import React from 'react';\r\nimport ScrollToBottom from 'react-scroll-to-bottom';\r\nimport Message from '../Message';\r\nimport './index.scss';\r\n\r\nconst Messages = ({ messages, name, ...rest }) => (\r\n  <ScrollToBottom className=\"chat__messages\">\r\n    {messages.map((message) => {\r\n      return (\r\n        <Message\r\n          key={`name-${message.id}`}\r\n          message={message}\r\n          name={name}\r\n          {...rest}\r\n        />\r\n      );\r\n    })}\r\n  </ScrollToBottom>\r\n);\r\n\r\nexport default React.memo(Messages);\r\n","export function dataURLtoFile(base64, config, callback) {\r\n  var arr = base64.split(','),\r\n    mime = arr[0].match(/:(.*?);/)[1],\r\n    bstr = atob(arr[1]),\r\n    n = bstr.length,\r\n    u8arr = new Uint8Array(n);\r\n  while (n--) {\r\n    u8arr[n] = bstr.charCodeAt(n);\r\n  }\r\n  return new File([u8arr], config.name, { type: mime });\r\n}\r\n\r\nexport function minifiedDataURL(readerDataUrl, config, callback) {\r\n  return new Promise((resolve) => {\r\n    // let video = document.createElement('video');\r\n    // video.setAttribute('src', readerDataUrl);\r\n    let img = new Image();\r\n    // 要從這裡讀取到type\r\n    img.src = readerDataUrl;\r\n    img.onload = () => {\r\n      // var that = this;\r\n      // 預設按比例壓縮\r\n      let width = img.width,\r\n        height = img.height,\r\n        scale = width / height;\r\n      const resizedWidth = 400;\r\n      let resizedHeight = resizedWidth / scale;\r\n      let quality = 0.7; // 預設圖片質量為0.7\r\n      //生成canvas\r\n      // 關鍵字\r\n      let canvas = document.createElement('canvas');\r\n      const ctx = canvas.getContext('2d');\r\n      // 建立屬性節點\r\n      const anw = document.createAttribute('width');\r\n      anw.nodeValue = resizedWidth;\r\n      const anh = document.createAttribute('height');\r\n      anh.nodeValue = resizedHeight;\r\n      canvas.setAttributeNode(anw);\r\n      canvas.setAttributeNode(anh);\r\n      ctx.drawImage(img, 0, 0, resizedWidth, resizedHeight);\r\n      // 影象質量\r\n      if (config.quality && config.quality <= 1 && config.quality > 0) {\r\n        quality = config.quality;\r\n      }\r\n      /*\r\n          我們只需要把<img>獲取到的圖片放到<canvas>裡再通過.toDataURL()方法轉化下，\r\n          就可以得到以 base64 編碼的 dataURL。來看這個方法的語法： \r\n          */\r\n      var base64 = canvas.toDataURL('image/jpeg', 'image/webp', quality);\r\n      const newFile = dataURLtoFile(base64, config, callback);\r\n      resolve(newFile);\r\n    };\r\n  });\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport qs from 'query-string';\r\nimport io from 'socket.io-client';\r\n// import { Container } from 'react-bootstrap';\r\nimport Input from '../Input';\r\nimport InfoBar from '../InfoBar';\r\nimport Messages from '../Messages';\r\nimport FileProcessor from '../../util/FileProcessor';\r\n\r\nlet socket;\r\n\r\nconst Chat = () => {\r\n  let { search } = useLocation();\r\n  const [name, setName] = useState('');\r\n  const [room, setRoom] = useState('');\r\n  const [message, setMessage] = useState(null);\r\n  const [messages, setMessages] = useState([]);\r\n  const [counts, setCounts] = useState(0);\r\n\r\n  let ENDPOINT = 'localhost:5000';\r\n  if (process.env.NODE_ENV === 'production') {\r\n    ENDPOINT = 'https://dailytalk.herokuapp.com';\r\n  }\r\n  console.log(ENDPOINT);\r\n  useEffect(() => {\r\n    const { name, room } = qs.parse(search);\r\n    socket = io(ENDPOINT, {\r\n      path: '/socket.io',\r\n      transports: ['websocket'],\r\n      secure: true,\r\n    });\r\n    setName(name);\r\n    setRoom(room);\r\n\r\n    socket.emit('join', { name, room }, (error) => {\r\n      if (error) {\r\n        alert(error);\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      socket.emit('disconnect');\r\n      socket.off();\r\n    };\r\n  }, [ENDPOINT, search]);\r\n\r\n  useEffect(() => {\r\n    const getMessage = (element, id) => element.id === id;\r\n    const addMessage = ({ messages, id, upload = '', user, type, percent }) => {\r\n      return [\r\n        ...messages,\r\n        {\r\n          id,\r\n          upload,\r\n          user,\r\n          type,\r\n          percent,\r\n        },\r\n      ];\r\n    };\r\n    const updateMessage = (index, messages, payload) => {\r\n      messages[index] = {\r\n        ...messages[index],\r\n        ...payload,\r\n      };\r\n      return [...messages];\r\n    };\r\n    socket.on('message', (message) =>\r\n      setMessages((messages) => {\r\n        return [...messages, message];\r\n      })\r\n    );\r\n    socket.on('percent', (amount, { id, user, type }) => {\r\n      setMessages((messages) => {\r\n        const messageIndex = messages.findIndex((message) =>\r\n          getMessage(message, id)\r\n        );\r\n        if (messageIndex < 0) {\r\n          const config = {\r\n            messages,\r\n            id,\r\n            percent: amount,\r\n            user,\r\n            type,\r\n          };\r\n          return addMessage(config);\r\n        } else {\r\n          messages[messageIndex].percent = amount;\r\n          return [...messages];\r\n        }\r\n      });\r\n    });\r\n    socket.on('file', ({ user, upload, type, id }) => {\r\n      if (upload) {\r\n        setMessages((messages) => {\r\n          const messageIndex = messages.findIndex((message) =>\r\n            getMessage(message, id)\r\n          );\r\n          const payload = {\r\n            id,\r\n            user,\r\n            upload,\r\n            type,\r\n          };\r\n          return updateMessage(messageIndex, messages, payload);\r\n        });\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    socket.on('roomData', ({ users }) => {\r\n      setCounts(users.length);\r\n    });\r\n  }, [counts]);\r\n\r\n  const sendMessage = (event) => {\r\n    event.preventDefault();\r\n    if (message) {\r\n      socket.emit('sendMessage', message, () => setMessage(''));\r\n    }\r\n  };\r\n\r\n  const sendFile = (file) => {\r\n    /* build => 非同步promise處裡檔案 */\r\n    FileProcessor.process(file, socket).then((minifiedFileProcessor) => {\r\n      minifiedFileProcessor.send();\r\n    });\r\n  };\r\n\r\n  const uploadFile = (file) => {\r\n    FileProcessor.process(file, socket).then((originalFileProcessor) =>\r\n      originalFileProcessor.upload()\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <InfoBar room={room} counts={counts} />\r\n      <Messages messages={messages} name={name} />\r\n      <Input\r\n        message={message}\r\n        setMessage={setMessage}\r\n        sendMessage={sendMessage}\r\n        sendFile={sendFile}\r\n        uploadFile={uploadFile}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n","import ss from 'socket.io-stream';\r\nimport { dataURLtoFile } from './FileConverter';\r\n\r\nclass FileProcessor {\r\n  constructor(file, socket, callback) {\r\n    console.log('檔案', file);\r\n\r\n    this.socket = socket;\r\n    this.file = file;\r\n    this.name = file.name;\r\n  }\r\n  static process(file, socket) {\r\n    const config = {\r\n      name: file.name,\r\n      quality: 0.6,\r\n      type: file.type\r\n    };\r\n    return convertToDataUrl(file, config)\r\n      .then(({ readerDataUrl, config, callback }) => {\r\n        this.base64 = readerDataUrl;\r\n        console.log('轉換成convertToDataUrl');\r\n        switch (config.type) {\r\n          // case 'image/jpeg': {\r\n          //   return minifiedDataURL(readerDataUrl, config, callback);\r\n          // }\r\n          case 'image/jpeg':\r\n          case 'video/mp4': {\r\n            return new Promise(resolve => {\r\n              const newFile = dataURLtoFile(readerDataUrl, config, callback);\r\n              resolve(newFile);\r\n            });\r\n          }\r\n          default: {\r\n            alert('the type is not supprted');\r\n          }\r\n        }\r\n      })\r\n      .then(data => {\r\n        this.data = data;\r\n        return new FileProcessor(this.data, socket);\r\n      });\r\n  }\r\n  send() {\r\n    console.log('送出', this, this.file.size);\r\n\r\n    const stream = ss.createStream();\r\n    const blobStream = ss.createBlobReadStream(this.file); //for browser use, 本來寫法是什麼\r\n    blobStream.pipe(stream);\r\n\r\n    ss(this.socket).emit('sendFile', stream, {\r\n      name: this.file.name,\r\n      type: this.file.type,\r\n      size: this.file.size\r\n    });\r\n    console.log('this.file', this.file);\r\n    // const totalSize = this.file.size;\r\n    // let size = 0;\r\n    // blobStream.on('data', function (chunk) {\r\n    //   size += chunk.length;\r\n    //   console.log('totalSize', totalSize);\r\n    //   console.log(Math.floor((size / totalSize) * 100) + '%');\r\n    // });\r\n    // console.log('完成Blob', Date());\r\n  }\r\n\r\n  upload() {\r\n    const stream = ss.createStream();\r\n    ss(this.socket).emit('uploadFile', stream, {\r\n      name: this.file.name,\r\n      type: this.file.type,\r\n      size: this.file.size\r\n    });\r\n    const blobStream = ss.createBlobReadStream(this.file); //for browser use, 本來寫法是什麼\r\n    // let size = 0;\r\n    // blobStream.on('data', function(chunk) {\r\n    //   size += chunk.length;\r\n    //   console.log(Math.floor((size / file.size) * 100) + '%');\r\n    // });\r\n    blobStream.pipe(stream);\r\n  }\r\n}\r\nconst convertToDataUrl = async (file, config, callback) => {\r\n  // 王牌文件 https://kknews.cc/zh-tw/code/e6p2ygq.html\r\n  // 神文 https://codertw.com/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/227679/\r\n  /* 使用FileReader對象分三步走： 一 創建FileReader實例 */\r\n  // var reader = new FileReader();\r\n  /* 開始讀取指定的Blob物件或File物件中的內容. 當讀取操作完成時,readyState屬性的值會成為DONE,\r\n    如果設定了onloadend事件處理程式,則呼叫之.\r\n    同時,result屬性中將包含一個data: URL格式的字串以表示所讀取檔案的內容.\r\n  */\r\n\r\n  /* 讀取Blob或者File對象的數據內容 */\r\n  // reader.readAsDataURL(file); // 讀取文件內容，結果用data:url的字符串形式表示\r\n\r\n  // reader.onloadstart = function() {\r\n  //   console.log('加載已經開始');\r\n  // };\r\n  // reader.onprogress = function(what) {\r\n  //   console.log('啥', what); //注意必包\r\n  // };\r\n  /** 設置回調函數，這裡以讀取成功的回調函數為例： */\r\n  const addImageProcess = (file, config, callback) => {\r\n    return new Promise((resolve, reject) => {\r\n      var reader = new FileReader();\r\n      reader.readAsDataURL(file); // 讀取文件內容，結果用data:url的字符串形式表示\r\n      reader.onload = function() {\r\n        const readerDataUrl = this.result;\r\n        console.log('加載開始');\r\n        resolve({ readerDataUrl, config, callback });\r\n      };\r\n      reader.onerror = () => reject('加载失败');\r\n      reader.onloadend = function() {\r\n        console.log('加載已經結束');\r\n      };\r\n    });\r\n  };\r\n  return await addImageProcess(file, config, callback);\r\n};\r\n\r\n// const convertToDataUrl2 = (file, config, callback) => {\r\n//   return new Promise(resolve => {\r\n//     // 王牌文件 https://kknews.cc/zh-tw/code/e6p2ygq.html\r\n//     // 神文 https://codertw.com/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/227679/\r\n//     /* 使用FileReader對象分三步走： 一 創建FileReader實例 */\r\n//     var reader = new FileReader();\r\n//     /* 開始讀取指定的Blob物件或File物件中的內容. 當讀取操作完成時,readyState屬性的值會成為DONE,\r\n//     如果設定了onloadend事件處理程式,則呼叫之.\r\n//     同時,result屬性中將包含一個data: URL格式的字串以表示所讀取檔案的內容.\r\n//   */\r\n\r\n//     /* 讀取Blob或者File對象的數據內容 */\r\n//     reader.readAsDataURL(file); // 讀取文件內容，結果用data:url的字符串形式表示\r\n\r\n//     // reader.onloadstart = function() {\r\n//     //   console.log('加載已經開始');\r\n//     // };\r\n//     // reader.onprogress = function(what) {\r\n//     //   console.log('啥', what); //注意必包\r\n//     // };\r\n//     /** 設置回調函數，這裡以讀取成功的回調函數為例： */\r\n//     reader.onload = function() {\r\n//       const readerDataUrl = this.result;\r\n//       console.log('加載開始');\r\n\r\n//       resolve({ readerDataUrl, config, callback });\r\n//     };\r\n//     reader.onloadend = function() {\r\n//       console.log('加載已經結束');\r\n//     };\r\n//   });\r\n// };\r\n\r\nexport default FileProcessor;\r\n","import React from 'react';\r\n// import PropTypes from 'prop-types';\r\nimport './index.scss';\r\n// import useMediaQuery from '../../util/useMediaQuery';\r\n\r\nconst Box = ({ title, content, control }) => {\r\n  // const mediaQuery = useMediaQuery();\r\n  return (\r\n    <div className=\"chat__box\">\r\n      <h1>{title}</h1>\r\n      {content}\r\n      <div>{control}</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nBox.defaultProps = {\r\n  setHasNotification: () => {},\r\n  hasNotification: false,\r\n};\r\n\r\nexport default Box;\r\n","import axios from 'axios';\r\n\r\nlet API_URL = 'https://localhost:5000/api/auth/';\r\n// if (process.env.NODE_ENV === 'production') {\r\nAPI_URL = 'https://dailytalk.herokuapp.com/api/auth/';\r\n// }\r\nclass AuthService {\r\n  login(username, password) {\r\n    return axios\r\n      .post(API_URL + 'signin', {\r\n        username,\r\n        password,\r\n      })\r\n      .then((response) => {\r\n        if (response.data.accessToken) {\r\n          localStorage.setItem('user', JSON.stringify(response.data));\r\n        }\r\n\r\n        return response.data;\r\n      });\r\n  }\r\n\r\n  logout() {\r\n    localStorage.removeItem('user');\r\n  }\r\n\r\n  signup(username, email, password, roles) {\r\n    return axios.post(API_URL + 'signup', {\r\n      username,\r\n      email,\r\n      password,\r\n      roles,\r\n    });\r\n  }\r\n\r\n  getCurrentUser() {\r\n    return JSON.parse(localStorage.getItem('user'));\r\n  }\r\n}\r\n\r\nexport default new AuthService();\r\n","import React, { useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport Box from '../Box';\r\nimport { Button, Form } from 'react-bootstrap';\r\nimport './index.scss';\r\n\r\nconst Join = () => {\r\n  const [name, setName] = useState('');\r\n  const [room, setRoom] = useState('');\r\n  const [avatar, setAvatar] = useState();\r\n  const handleChange = (event) => {\r\n    setAvatar(URL.createObjectURL(event.target.files[0]));\r\n  };\r\n  return (\r\n    <Box\r\n      title=\"Join\"\r\n      content={\r\n        <Form>\r\n          <input type=\"file\" onChange={handleChange} />\r\n          <img width=\"50px\" src={avatar} />\r\n          <Form.Group controlId=\"formBasicPassword\">\r\n            <Form.Label>Username</Form.Label>\r\n            <Form.Control\r\n              type=\"text\"\r\n              placeholder=\"Username\"\r\n              onChange={(e) => setName(e.target.value)}\r\n            />\r\n            <Form.Label>Room</Form.Label>\r\n            <Form.Control\r\n              type=\"text\"\r\n              placeholder=\"Room\"\r\n              onChange={(e) => setRoom(e.target.value)}\r\n            />\r\n          </Form.Group>\r\n        </Form>\r\n      }\r\n      control={\r\n        <Link\r\n          onClick={(event) => (!name || !room ? event.preventDefault() : null)}\r\n          to={`/chat?name=${name}&room=${room}`}\r\n        >\r\n          <Button block type=\"submit\">\r\n            Join In\r\n          </Button>\r\n        </Link>\r\n      }\r\n    />\r\n  );\r\n};\r\n\r\nexport default Join;\r\n","import React, { useState, useContext } from 'react';\r\nimport { Redirect } from 'react-router-dom';\r\nimport { Form, Button } from 'react-bootstrap';\r\n\r\nimport Box from '../Box';\r\nimport { NotificationContext } from '../../context/notification-context';\r\nimport AuthService from '../../util/auth';\r\nimport './index.scss';\r\n\r\nconst Login = (props) => {\r\n  const [notification, setNotification] = useContext(NotificationContext);\r\n  const [redirectToReferrer, setRedirectToReferrer] = useState(false);\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const login = (e) => {\r\n    e.preventDefault();\r\n    AuthService.login(username, password)\r\n      .then((response) => {\r\n        // 以驗證mongodb data以及設定localstorage\r\n        setRedirectToReferrer(true);\r\n      })\r\n      .catch((error) => {\r\n        setNotification({\r\n          status: error.name,\r\n          content: error.message,\r\n        });\r\n        setTimeout(() => {\r\n          setNotification({\r\n            status: null,\r\n            content: null,\r\n          });\r\n        }, 3000);\r\n      });\r\n  };\r\n  // const { from } = props.location.state || { from: { pathname: '/' } };\r\n  if (redirectToReferrer === true) {\r\n    return <Redirect to=\"join\" />;\r\n  }\r\n  const handleNameChange = (e) => {\r\n    setUsername(e.target.value);\r\n  };\r\n  const handlePasswordChange = (e) => {\r\n    setPassword(e.target.value);\r\n  };\r\n  return (\r\n    <>\r\n      <Box\r\n        title=\"Login\"\r\n        content={\r\n          <Form>\r\n            <Form.Group controlId=\"formBasicName\">\r\n              <Form.Label>Username</Form.Label>\r\n              <Form.Control\r\n                type=\"text\"\r\n                placeholder=\"Username\"\r\n                onChange={handleNameChange}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group controlId=\"formBasicPassword\">\r\n              <Form.Label>Password</Form.Label>\r\n              <Form.Control\r\n                type=\"password\"\r\n                placeholder=\"Password\"\r\n                onChange={handlePasswordChange}\r\n              />\r\n            </Form.Group>\r\n          </Form>\r\n        }\r\n        control={\r\n          <Button onClick={login} variant=\"primary\" type=\"submit\">\r\n            Submit\r\n          </Button>\r\n        }\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n","import React, { useState, useContext } from 'react';\r\nimport { Redirect } from 'react-router-dom';\r\nimport { Form, Button } from 'react-bootstrap';\r\nimport Box from '../Box';\r\nimport { NotificationContext } from '../../context/notification-context';\r\nimport AuthService from '../../util/auth';\r\n// import axios from 'axios';\r\nimport './index.scss';\r\n\r\nconst Signup = (props) => {\r\n  const [notification, setNotification] = useContext(NotificationContext);\r\n  const [username, setUsername] = useState('');\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [hasSignup, setHasSignup] = useState(false);\r\n\r\n  const signup = (e) => {\r\n    e.preventDefault();\r\n    AuthService.signup(username, email, password, ['user'])\r\n      .then((response) => {\r\n        setHasSignup(true);\r\n      })\r\n      .catch((error) => {\r\n        setNotification({\r\n          status: error.name,\r\n          content: error.message,\r\n        });\r\n        setTimeout(() => {\r\n          setNotification({\r\n            status: null,\r\n            content: null,\r\n          });\r\n        }, 3000);\r\n      });\r\n  };\r\n  const handleNameChange = (e) => {\r\n    setUsername(e.target.value);\r\n  };\r\n  const handleEmailChange = (e) => {\r\n    setEmail(e.target.value);\r\n  };\r\n  const handlePasswordChange = (e) => {\r\n    setPassword(e.target.value);\r\n  };\r\n  if (hasSignup) return <Redirect to=\"login\" />;\r\n  console.log('process', process.env);\r\n  return (\r\n    <Box\r\n      title=\"Sign Up\"\r\n      content={\r\n        <Form>\r\n          <Form.Group controlId=\"formBasicName\">\r\n            <Form.Label>Username</Form.Label>\r\n            <Form.Control\r\n              type=\"text\"\r\n              placeholder=\"Normal text\"\r\n              onChange={handleNameChange}\r\n              value={username}\r\n            />\r\n          </Form.Group>\r\n          <Form.Group controlId=\"formBasicEmail\">\r\n            <Form.Label>Email address</Form.Label>\r\n            <Form.Control\r\n              type=\"email\"\r\n              placeholder=\"Enter email\"\r\n              onChange={handleEmailChange}\r\n              value={email}\r\n            />\r\n          </Form.Group>\r\n          <Form.Group controlId=\"formBasicPassword\">\r\n            <Form.Label>Password</Form.Label>\r\n            <Form.Control\r\n              type=\"password\"\r\n              placeholder=\"Password\"\r\n              onChange={handlePasswordChange}\r\n              value={password}\r\n            />\r\n          </Form.Group>\r\n        </Form>\r\n      }\r\n      control={\r\n        <Button onClick={signup} variant=\"primary\" type=\"submit\">\r\n          Sign Up\r\n        </Button>\r\n      }\r\n    />\r\n  );\r\n};\r\n\r\nexport default Signup;\r\n","import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport AuthService from '../../util/auth';\r\nimport './index.scss';\r\n\r\nconst Home = () => (\r\n  <div className=\"chat-home\">\r\n    <h1>Fresh Talk</h1>\r\n    <div className=\"chat-home__controls\">\r\n      <Link to=\"/signup\">Sign up</Link>\r\n      {AuthService.getCurrentUser() ? (\r\n        <Link to=\"/join\">Join</Link>\r\n      ) : (\r\n        <Link to=\"/login\">Login</Link>\r\n      )}\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default Home;\r\n","import React, { useContext } from 'react';\r\nimport { NotificationContext } from '../../context/notification-context';\r\nimport './index.scss';\r\n\r\nconst Head = ({ children }) => {\r\n  const [notification] = useContext(NotificationContext);\r\n  console.log('提示', notification);\r\n  return (\r\n    <section className=\"chat__head\">\r\n      <div\r\n        className={`chat__notification chat__notification${\r\n          notification.status === 'Error' ? '--active' : ''\r\n        }`}\r\n      >\r\n        {notification.content}\r\n      </div>\r\n      <div className=\"chat__head-burgur\">{children}</div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Head;\r\n","import React from 'react';\r\nimport { Route, Redirect } from 'react-router-dom';\r\nimport AuthService from '../../util/auth';\r\n\r\nconst PrivateRoute = ({ component: Component, ...rest }) => (\r\n  <Route\r\n    {...rest}\r\n    render={(props) =>\r\n      AuthService.getCurrentUser() ? (\r\n        <Component {...props} />\r\n      ) : (\r\n        <Redirect\r\n          to={{\r\n            pathname: '/login',\r\n            state: { from: props.location },\r\n          }}\r\n        />\r\n      )\r\n    }\r\n  />\r\n);\r\n\r\nexport default PrivateRoute;\r\n","import React from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\n// import { Button } from 'react-bootstrap';\r\nimport { BoxArrowLeft } from 'react-bootstrap-icons';\r\nimport './index.scss';\r\nimport AuthService from '../../util/auth';\r\n\r\n/**\r\n * withRouter will pass updated match, location,\r\n * and history props to the wrapped component whenever it renders.\r\n */\r\nconst AuthButton = withRouter(\r\n  ({ history }) =>\r\n    AuthService.getCurrentUser() && (\r\n      <BoxArrowLeft\r\n        size=\"30\"\r\n        color=\"#fff\"\r\n        onClick={() => {\r\n          AuthService.logout();\r\n          history.push('/');\r\n        }}\r\n      >\r\n        Sign out\r\n      </BoxArrowLeft>\r\n    )\r\n);\r\n\r\nexport default AuthButton;\r\n","import React from 'react';\r\n// import { Toast } from 'react-bootstrap';\r\n\r\nimport {\r\n  BrowserRouter as Router,\r\n  // Link,\r\n  Route,\r\n  Redirect,\r\n  Switch,\r\n  // withRouter,\r\n} from 'react-router-dom';\r\nimport { NotificationContextProvider } from '../src/context/notification-context';\r\nimport {\r\n  Home,\r\n  Head,\r\n  Login,\r\n  Signup,\r\n  AuthButton,\r\n  Join,\r\n  Chat,\r\n  PrivateRoute,\r\n} from './components';\r\nimport './index.scss';\r\n// const NotFound = () => (\r\n//   <div>\r\n//     <p>The page does not exist</p>\r\n//   </div>\r\n// );\r\nconst App = () => (\r\n  <Router>\r\n    <NotificationContextProvider>\r\n      <Head>\r\n        <AuthButton />\r\n      </Head>\r\n      <Switch>\r\n        <Route path=\"/\" exact component={Home} />\r\n        <Route path=\"/Signup\" component={Signup} />\r\n        <Route path=\"/login\" component={Login} />\r\n        <PrivateRoute path=\"/join\" component={Join} />\r\n        <PrivateRoute path=\"/chat\" component={Chat} />\r\n        <Redirect from=\"*\" to=\"/\" />\r\n      </Switch>\r\n    </NotificationContextProvider>\r\n  </Router>\r\n);\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDom from 'react-dom';\r\nimport App from './App.js';\r\n\r\nReactDom.render(<App />, document.querySelector('#root'));\r\n"],"sourceRoot":""}