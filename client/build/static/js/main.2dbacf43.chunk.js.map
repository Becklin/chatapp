{"version":3,"sources":["context/notification-context.js","components/IconButton/index.js","components/Input/index.js","components/InfoBar/index.js","components/Message/index.js","components/Messages/index.js","util/FileConverter.js","components/Chat/index.js","util/FileProcessor.js","components/Box/index.js","components/Join/index.js","util/auth.js","components/Login/index.js","components/Signup/index.js","components/Home/index.js","components/Head/index.js","components/PrivateRoute/index.js","components/AuthButton/index.js","App.js","index.js"],"names":["NotificationContext","createContext","NotificationContextProvider","children","useState","notification","setNotification","Provider","value","IconButton","onHandleClick","className","name","disabled","icon","iconName","htmlFor","type","id","accept","onChange","e","files","Array","from","target","formData","FormData","append","get","Input","message","setMessage","sendMessage","sendFile","uploadFile","console","log","placeholder","event","onKeyPress","key","size","onClick","color","InfoBar","room","counts","to","React","memo","Message","avatarSrc","user","content","upload","address","percent","date","isSentByCurrentUser","trimmedName","trim","toLowerCase","role","title","src","roundedCircle","ProgressBar","now","animated","renderProgress","moment","format","dangerouslySetInnerHTML","__html","width","controls","renderFile","ReactEmoji","emojify","Messages","messages","rest","map","dataURLtoFile","base64","config","arr","split","mime","match","bstr","atob","n","length","u8arr","Uint8Array","charCodeAt","File","socket","FileProcessor","file","this","stream","ss","createStream","createBlobReadStream","pipe","emit","quality","convertToDataUrl","then","readerDataUrl","callback","Promise","resolve","alert","data","a","addImageProcess","reject","reader","FileReader","readAsDataURL","onload","result","onerror","onloadend","Chat","search","useLocation","setName","setRoom","setMessages","setCounts","ENDPOINT","useEffect","qs","parse","io","path","transports","secure","error","off","getMessage","element","on","amount","messageIndex","findIndex","addMessage","index","payload","updateMessage","users","preventDefault","process","minifiedFileProcessor","send","originalFileProcessor","Box","control","Join","avatar","setAvatar","Form","URL","createObjectURL","Group","controlId","Label","Control","Button","block","API_URL","username","password","axios","post","response","accessToken","localStorage","setItem","JSON","stringify","catch","err","removeItem","email","getItem","Login","useContext","redirectToReferrer","setRedirectToReferrer","setUsername","setPassword","AuthService","login","status","setTimeout","variant","Signup","setEmail","hasSignup","setHasSignup","signup","Home","getCurrentUser","Head","PrivateRoute","Component","component","location","render","props","pathname","state","AuthButton","withRouter","history","logout","push","App","exact","ReactDom","document","querySelector"],"mappings":"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","file":"static/js/main.2dbacf43.chunk.js","sourcesContent":["import React, { useState, createContext } from 'react';\nimport PropTypes from 'prop-types';\n\n// Create Context Object\nexport const NotificationContext = createContext();\n\n// Create a provider for components to consume and subscribe to changes\nexport const NotificationContextProvider = ({children}) => {\n  const [notification, setNotification] = useState({});\n\n  return (\n    <NotificationContext.Provider value={[notification, setNotification]}>\n      {children}\n    </NotificationContext.Provider>\n  );\n};\n\nNotificationContextProvider.propTypes = {\n  children: PropTypes.oneOfType([\n      PropTypes.arrayOf(PropTypes.node),\n      PropTypes.node\n  ]).isRequired\n};\n\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './index.scss';\n\n//USER送發訊息的人，name該聊天室使用者名字\nconst IconButton = ({ onHandleClick, className, name, disabled, icon }) => {\n  const onChange = (e) => {\n    const files = Array.from(e.target.files);\n    let formData = new FormData();\n    formData.append(0, files[0]);\n    onHandleClick(formData.get(0));\n  };\n  const iconName = `icon-${name}`;\n  return (\n    <span className={`chat__icon ${className} ${disabled ? 'disabled' : ''}`}>\n      <label className=\"chat__label\" htmlFor={iconName}>\n        {icon && icon}\n      </label>\n      <input\n        className=\"hidden-input\"\n        type=\"file\"\n        name={iconName}\n        id={iconName}\n        accept=\"image/*,video/*,audio/*\"\n        onChange={onChange}\n      />\n    </span>\n  );\n};\n\nIconButton.propTypes = {\n  onHandleClick: PropTypes.func,\n  className: PropTypes.string,\n  name: PropTypes.string,\n  disabled: PropTypes.bool,\n  icon: PropTypes.element,\n}\n\nexport default IconButton;\n","import React from 'react';\n// import { Row, Col, Button } from 'react-bootstrap';\nimport PropTypes from 'prop-types';\nimport { ChatTextFill, CloudUploadFill, Image } from 'react-bootstrap-icons';\nimport IconButton from '../IconButton';\nimport './index.scss';\n\nconst Input = ({\n  message = '',\n  setMessage,\n  sendMessage,\n  sendFile,\n  uploadFile,\n}) => {\n  const handleSendMessage = (event) => {\n    sendMessage(event);\n  };\n  console.log('信息', message);\n  return (\n    <form className=\"chat__form\">\n      <textarea\n        className=\"chat__message\"\n        placeholder=\"write some message...\"\n        value={message}\n        onChange={(event) => setMessage(event.target.value)}\n        onKeyPress={(event) =>\n          event.key === 'Enter' ? setMessage(event.target.value) : null\n        }\n      />\n      <div className=\"chat__controls\">\n        <IconButton\n          disabled={message}\n          className=\"chat__flex\"\n          type=\"file\"\n          onHandleClick={sendFile}\n          icon={<Image />}\n          name=\"files\"\n        />\n        <IconButton\n          disabled={message}\n          className=\"chat__flex\"\n          type=\"file\"\n          onHandleClick={uploadFile}\n          icon={<CloudUploadFill />}\n          name=\"upload\"\n        />\n        <ChatTextFill\n          className=\"chat__flex\"\n          size=\"32\"\n          onClick={message ? handleSendMessage : null}\n          color={message ? 'darkslategray' : '#e3e3e3'}\n        />\n      </div>\n    </form>\n  );\n};\n\nInput.propTypes = {\n  message: PropTypes.string,\n  setMessage: PropTypes.func,\n  sendMessage: PropTypes.func,\n  sendFile: PropTypes.func,\n  uploadFile: PropTypes.func,\n}\n\nexport default Input;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport PropTypes from 'prop-types';\n\n// import { Row, Col } from 'react-bootstrap';\nimport { ArrowLeftCircle, PeopleFill } from 'react-bootstrap-icons';\nimport './index.scss';\n\nconst InfoBar = ({ room, counts }) => (\n  <div className=\"chat__infoBar\">\n    <div className=\"chat__room\">\n      <h3>{room}</h3>\n    </div>\n    <div className=\"chat__count\">\n      {counts} <PeopleFill color=\"#ffffff\" size={24} />\n    </div>\n    <div className=\"chat__back\">\n      <Link to=\"/\">\n        <ArrowLeftCircle color=\"white\" size={24} />\n      </Link>\n    </div>\n  </div>\n);\n\nInfoBar.propTypes = {\n  room: PropTypes.string,\n  counts: PropTypes.number,\n}\n\nexport default React.memo(InfoBar);\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Image, ProgressBar } from 'react-bootstrap';\nimport { PersonCircle } from 'react-bootstrap-icons';\nimport ReactEmoji from 'react-emoji';\nimport moment from 'moment';\nimport './index.scss';\n\n//USER送發訊息的人，name該聊天室使用者名字\nconst Message = ({\n  message,\n  name,\n  avatarSrc,\n}) => {\n  // console.log('最後', user, content, message);\n  const { user, content, upload, type, address, percent, date } = message;\n  let isSentByCurrentUser = false;\n  const trimmedName = name.trim().toLowerCase();\n  if (trimmedName === user) isSentByCurrentUser = true;\n  const role = isSentByCurrentUser ? 'user' : 'friend';\n  const title = role === 'user' ? trimmedName : user;\n  const renderProgress = (percent) => {\n    if (percent > 0 && percent < 100)\n      return (\n        <>\n          loading...\n          <ProgressBar now={percent} animated />\n        </>\n      );\n  };\n\n  const renderFile = ({ address, type, upload }) => {\n    if (address) return <div dangerouslySetInnerHTML={{ __html: address }} />;\n    if (type && upload) {\n      switch (type) {\n        case 'video/mp4': {\n          return (\n            <video width=\"100%\" controls>\n              <source\n                src={`data:image/png;base64, ${upload}`}\n                type=\"video/mp4\"\n              />\n              <source\n                src={`data:image/png;base64, ${upload}`}\n                type=\"video/ogg\"\n              />\n              Your browser does not support the video tag.\n            </video>\n          );\n        }\n        case 'image/*':\n          return (\n            <img\n              className=\"img-thumbnail img-fluid\"\n              src={`data:image/png;base64, ${upload}`}\n            />\n          );\n        default:\n          return (\n            <img\n              className=\"img-thumbnail img-fluid\"\n              src={`data:image/png;base64, ${upload}`}\n            />\n          );\n      }\n    }\n  };\n\n  return (\n    <div className={`chat-message chat-message--${role}`}>\n      {role === 'friend' && (\n        <h4>\n          {avatarSrc ? (\n            <Image src={avatarSrc} roundedCircle />\n          ) : (\n            <PersonCircle size={24} />\n          )}\n          <span>{title}</span>\n        </h4>\n      )}\n      <div className=\"chat-message__body\">\n        {renderProgress(percent)}\n        <span className=\"chat-message__date\">{moment(date).format('LTS')}</span>\n        {renderFile({ address, percent, type, upload })}\n        {content && (\n          <p className=\"chat-message__body--text\">\n            {ReactEmoji.emojify(content)}\n          </p>\n        )}\n      </div>\n    </div>\n  );\n};\n\nMessage.propTypes = {\n  message: PropTypes.object,\n  counts: PropTypes.number,\n  name: PropTypes.string,\n  avatarSrc: PropTypes.string,\n}\n\nexport default Message;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport ScrollToBottom from 'react-scroll-to-bottom';\nimport Message from '../Message';\nimport './index.scss';\n\nconst Messages = ({ messages, name, ...rest }) => (\n  <ScrollToBottom className=\"chat__messages\">\n    {messages.map((message) => {\n      return (\n        <Message\n          key={`name-${message.id}`}\n          message={message}\n          name={name}\n          {...rest}\n        />\n      );\n    })}\n  </ScrollToBottom>\n);\n\nMessages.propTypes = {\n  messages: PropTypes.any,\n  name: PropTypes.string,\n}\n\nexport default React.memo(Messages);\n","export function dataURLtoFile(base64, config) {\n  var arr = base64.split(','),\n    mime = arr[0].match(/:(.*?);/)[1],\n    bstr = atob(arr[1]),\n    n = bstr.length,\n    u8arr = new Uint8Array(n);\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n);\n  }\n  return new File([u8arr], config.name, { type: mime });\n}\n\nexport function minifiedDataURL(readerDataUrl, config, callback) {\n  return new Promise((resolve) => {\n    // let video = document.createElement('video');\n    // video.setAttribute('src', readerDataUrl);\n    let img = new Image();\n    // 要從這裡讀取到type\n    img.src = readerDataUrl;\n    img.onload = () => {\n      // var that = this;\n      // 預設按比例壓縮\n      let width = img.width,\n        height = img.height,\n        scale = width / height;\n      const resizedWidth = 400;\n      let resizedHeight = resizedWidth / scale;\n      let quality = 0.7; // 預設圖片質量為0.7\n      //生成canvas\n      // 關鍵字\n      let canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n      // 建立屬性節點\n      const anw = document.createAttribute('width');\n      anw.nodeValue = resizedWidth;\n      const anh = document.createAttribute('height');\n      anh.nodeValue = resizedHeight;\n      canvas.setAttributeNode(anw);\n      canvas.setAttributeNode(anh);\n      ctx.drawImage(img, 0, 0, resizedWidth, resizedHeight);\n      // 影象質量\n      if (config.quality && config.quality <= 1 && config.quality > 0) {\n        quality = config.quality;\n      }\n      /*\n          我們只需要把<img>獲取到的圖片放到<canvas>裡再通過.toDataURL()方法轉化下，\n          就可以得到以 base64 編碼的 dataURL。來看這個方法的語法： \n          */\n      var base64 = canvas.toDataURL('image/jpeg', 'image/webp', quality);\n      const newFile = dataURLtoFile(base64, config, callback);\n      resolve(newFile);\n    };\n  });\n}\n","import React, { useState, useEffect } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport qs from 'query-string';\nimport io from 'socket.io-client';\n// import { Container } from 'react-bootstrap';\nimport Input from '../Input';\nimport InfoBar from '../InfoBar';\nimport Messages from '../Messages';\nimport FileProcessor from '../../util/FileProcessor';\n\nlet socket;\n\nconst Chat = () => {\n  let { search } = useLocation();\n  const [name, setName] = useState('');\n  const [room, setRoom] = useState('');\n  const [message, setMessage] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [counts, setCounts] = useState(0);\n\n  let ENDPOINT = 'localhost:5000';\n  if (process.env.NODE_ENV === 'production') {\n    ENDPOINT = 'https://dailytalk.herokuapp.com';\n  }\n  console.log(ENDPOINT);\n  useEffect(() => {\n    const { name, room } = qs.parse(search);\n    socket = io(ENDPOINT, {\n      path: '/socket.io',\n      transports: ['websocket'],\n      secure: true,\n    });\n    setName(name);\n    setRoom(room);\n\n    socket.emit('join', { name, room }, (error) => {\n      if (error) {\n        alert(error);\n      }\n    });\n\n    return () => {\n      socket.emit('disconnect');\n      socket.off();\n    };\n  }, [ENDPOINT, search]);\n\n  useEffect(() => {\n    const getMessage = (element, id) => element.id === id;\n    const addMessage = ({ messages, id, upload = '', user, type, percent }) => {\n      return [\n        ...messages,\n        {\n          id,\n          upload,\n          user,\n          type,\n          percent,\n        },\n      ];\n    };\n    const updateMessage = (index, messages, payload) => {\n      messages[index] = {\n        ...messages[index],\n        ...payload,\n      };\n      return [...messages];\n    };\n    socket.on('message', (message) =>\n      setMessages((messages) => {\n        return [...messages, message];\n      })\n    );\n    socket.on('percent', (amount, { id, user, type }) => {\n      setMessages((messages) => {\n        const messageIndex = messages.findIndex((message) =>\n          getMessage(message, id)\n        );\n        if (messageIndex < 0) {\n          const config = {\n            messages,\n            id,\n            percent: amount,\n            user,\n            type,\n          };\n          return addMessage(config);\n        } else {\n          messages[messageIndex].percent = amount;\n          return [...messages];\n        }\n      });\n    });\n    socket.on('file', ({ user, upload, type, id }) => {\n      if (upload) {\n        setMessages((messages) => {\n          const messageIndex = messages.findIndex((message) =>\n            getMessage(message, id)\n          );\n          const payload = {\n            id,\n            user,\n            upload,\n            type,\n          };\n          return updateMessage(messageIndex, messages, payload);\n        });\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    socket.on('roomData', ({ users }) => {\n      setCounts(users.length);\n    });\n  }, [counts]);\n\n  const sendMessage = (event) => {\n    event.preventDefault();\n    if (message) {\n      socket.emit('sendMessage', message, () => setMessage(''));\n    }\n  };\n\n  const sendFile = (file) => {\n    /* build => 非同步promise處裡檔案 */\n    FileProcessor.process(file, socket).then((minifiedFileProcessor) => {\n      minifiedFileProcessor.send();\n    });\n  };\n\n  const uploadFile = (file) => {\n    FileProcessor.process(file, socket).then((originalFileProcessor) =>\n      originalFileProcessor.upload()\n    );\n  };\n\n  return (\n    <>\n      <InfoBar room={room} counts={counts} />\n      <Messages messages={messages} name={name} />\n      <Input\n        message={message}\n        setMessage={setMessage}\n        sendMessage={sendMessage}\n        sendFile={sendFile}\n        uploadFile={uploadFile}\n      />\n    </>\n  );\n};\n\nexport default Chat;\n","import ss from 'socket.io-stream';\nimport { dataURLtoFile } from './FileConverter';\n\nclass FileProcessor {\n  constructor(file, socket) {\n    console.log('檔案', file);\n\n    this.socket = socket;\n    this.file = file;\n    this.name = file.name;\n  }\n  static process(file, socket) {\n    const config = {\n      name: file.name,\n      quality: 0.6,\n      type: file.type\n    };\n    return convertToDataUrl(file, config)\n      .then(({ readerDataUrl, config, callback }) => {\n        this.base64 = readerDataUrl;\n        console.log('轉換成convertToDataUrl');\n        switch (config.type) {\n          // case 'image/jpeg': {\n          //   return minifiedDataURL(readerDataUrl, config, callback);\n          // }\n          case 'image/jpeg':\n          case 'video/mp4': {\n            return new Promise(resolve => {\n              const newFile = dataURLtoFile(readerDataUrl, config, callback);\n              resolve(newFile);\n            });\n          }\n          default: {\n            alert('the type is not supprted');\n          }\n        }\n      })\n      .then(data => {\n        this.data = data;\n        console.log(\"資料\", data);\n        return new FileProcessor(this.data, socket);\n      });\n  }\n  send() {\n    console.log('送出', this, this.file.size);\n    const stream = ss.createStream();\n    const blobStream = ss.createBlobReadStream(this.file); //for browser use, 本來寫法是什麼\n    blobStream.pipe(stream);\n\n    ss(this.socket).emit('sendFile', stream, {\n      name: this.file.name,\n      type: this.file.type,\n      size: this.file.size\n    });\n    console.log('this.file', this.file);\n  }\n\n  upload() {\n    const stream = ss.createStream();\n    ss(this.socket).emit('uploadFile', stream, {\n      name: this.file.name,\n      type: this.file.type,\n      size: this.file.size\n    });\n    const blobStream = ss.createBlobReadStream(this.file); //for browser use, 本來寫法是什麼\n    blobStream.pipe(stream);\n  }\n}\nconst convertToDataUrl = async (file, config, callback) => {\n  // 王牌文件 https://kknews.cc/zh-tw/code/e6p2ygq.html\n  // 神文 https://codertw.com/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/227679/\n  /* 使用FileReader對象分三步走： 一 創建FileReader實例 */\n  // var reader = new FileReader();\n  /* 開始讀取指定的Blob物件或File物件中的內容. 當讀取操作完成時,readyState屬性的值會成為DONE,\n    如果設定了onloadend事件處理程式,則呼叫之.\n    同時,result屬性中將包含一個data: URL格式的字串以表示所讀取檔案的內容.\n  */\n\n  /* 讀取Blob或者File對象的數據內容 */\n  // reader.readAsDataURL(file); // 讀取文件內容，結果用data:url的字符串形式表示\n\n  // reader.onloadstart = function() {\n  //   console.log('加載已經開始');\n  // };\n  // reader.onprogress = function(what) {\n  //   console.log('啥', what); //注意必包\n  // };\n  /** 設置回調函數，這裡以讀取成功的回調函數為例： */\n  const addImageProcess = (file, config, callback) => {\n    return new Promise((resolve, reject) => {\n      var reader = new FileReader();\n      reader.readAsDataURL(file); // 讀取文件內容，結果用data:url的字符串形式表示\n      reader.onload = function() {\n        const readerDataUrl = this.result;\n        console.log('加載開始');\n        resolve({ readerDataUrl, config, callback });\n      };\n      reader.onerror = () => reject('加载失败');\n      reader.onloadend = function() {\n        console.log('加載已經結束');\n      };\n    });\n  };\n  return await addImageProcess(file, config, callback);\n};\n\n// const convertToDataUrl2 = (file, config, callback) => {\n//   return new Promise(resolve => {\n//     // 王牌文件 https://kknews.cc/zh-tw/code/e6p2ygq.html\n//     // 神文 https://codertw.com/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/227679/\n//     /* 使用FileReader對象分三步走： 一 創建FileReader實例 */\n//     var reader = new FileReader();\n//     /* 開始讀取指定的Blob物件或File物件中的內容. 當讀取操作完成時,readyState屬性的值會成為DONE,\n//     如果設定了onloadend事件處理程式,則呼叫之.\n//     同時,result屬性中將包含一個data: URL格式的字串以表示所讀取檔案的內容.\n//   */\n\n//     /* 讀取Blob或者File對象的數據內容 */\n//     reader.readAsDataURL(file); // 讀取文件內容，結果用data:url的字符串形式表示\n\n//     // reader.onloadstart = function() {\n//     //   console.log('加載已經開始');\n//     // };\n//     // reader.onprogress = function(what) {\n//     //   console.log('啥', what); //注意必包\n//     // };\n//     /** 設置回調函數，這裡以讀取成功的回調函數為例： */\n//     reader.onload = function() {\n//       const readerDataUrl = this.result;\n//       console.log('加載開始');\n\n//       resolve({ readerDataUrl, config, callback });\n//     };\n//     reader.onloadend = function() {\n//       console.log('加載已經結束');\n//     };\n//   });\n// };\n\nexport default FileProcessor;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './index.scss';\n// import useMediaQuery from '../../util/useMediaQuery';\n\nconst Box = ({ title, content, control }) => {\n  return (\n    <div className=\"chat__box\">\n      <h1>{title}</h1>\n      {content}\n      <div>{control}</div>\n    </div>\n  );\n};\n\nBox.propTypes = {\n  title: PropTypes.string,\n  content: PropTypes.func,\n  control: PropTypes.element\n};\n\nexport default Box;\n","import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport Box from '../Box';\nimport { Button, Form } from 'react-bootstrap';\nimport './index.scss';\n\nconst Join = () => {\n  const [name, setName] = useState('');\n  const [room, setRoom] = useState('');\n  const [avatar, setAvatar] = useState();\n  const handleChange = (event) => {\n    setAvatar(URL.createObjectURL(event.target.files[0]));\n  };\n  return (\n    <Box\n      title=\"Join\"\n      content={\n        <Form>\n          <input type=\"file\" onChange={handleChange} />\n          <img width=\"50px\" src={avatar} />\n          <Form.Group controlId=\"formBasicPassword\">\n            <Form.Label>Username</Form.Label>\n            <Form.Control\n              type=\"text\"\n              placeholder=\"Username\"\n              onChange={(e) => setName(e.target.value)}\n            />\n            <Form.Label>Room</Form.Label>\n            <Form.Control\n              type=\"text\"\n              placeholder=\"Room\"\n              onChange={(e) => setRoom(e.target.value)}\n            />\n          </Form.Group>\n        </Form>\n      }\n      control={\n        <Link\n          onClick={(event) => (!name || !room ? event.preventDefault() : null)}\n          to={`/chat?name=${name}&room=${room}`}\n        >\n          <Button block type=\"submit\">\n            Join In\n          </Button>\n        </Link>\n      }\n    />\n  );\n};\n\nexport default Join;\n","import axios from 'axios';\n\nlet API_URL = '/api/auth/';\nif (process.env.NODE_ENV === 'production') {\n  API_URL = 'https://dailytalk.herokuapp.com/api/auth/';\n}\nconsole.log(API_URL);\nclass AuthService {\n  login(username, password) {\n    return axios\n      .post(API_URL + 'signin', {\n        username,\n        password\n      })\n      .then(response => {\n        if (response.data.accessToken) {\n          localStorage.setItem('user', JSON.stringify(response.data));\n        }\n        console.log(\"lresponse.data\", response.data);\n        return response.data;\n      })\n      .catch((err) => {\n        console.log(\"login err\", err);\n      });\n  }\n\n  logout() {\n    localStorage.removeItem('user');\n  }\n\n  signup(username, email, password) {\n    return axios.post(API_URL + 'signup', {\n      username,\n      email,\n      password\n    });\n  }\n\n  getCurrentUser() {\n    return JSON.parse(localStorage.getItem('user'));\n  }\n}\n\nexport default new AuthService();\n","import React, { useState, useContext } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { Form, Button } from 'react-bootstrap';\n\nimport Box from '../Box';\nimport { NotificationContext } from '../../context/notification-context';\nimport AuthService from '../../util/auth';\nimport './index.scss';\n\nconst Login = () => {\n  const [notification, setNotification] = useContext(NotificationContext);\n  const [redirectToReferrer, setRedirectToReferrer] = useState(false);\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const login = (e) => {\n    e.preventDefault();\n    AuthService.login(username, password)\n      .then(() => {\n        // 以驗證mongodb data以及設定localstorage\n        setRedirectToReferrer(true);\n      })\n      .catch((error) => {\n        setNotification({\n          status: error.name,\n          content: error.message,\n        });\n        setTimeout(() => {\n          setNotification({\n            status: null,\n            content: null,\n          });\n        }, 3000);\n      });\n  };\n  // const { from } = props.location.state || { from: { pathname: '/' } };\n  if (redirectToReferrer === true) {\n    return <Redirect to=\"join\" />;\n  }\n  const handleNameChange = (e) => {\n    setUsername(e.target.value);\n  };\n  const handlePasswordChange = (e) => {\n    setPassword(e.target.value);\n  };\n  console.log(notification);\n  return (\n    <>\n\n      <Box\n        title=\"Login\"\n        content={\n          <Form>\n            <Form.Group controlId=\"formBasicName\">\n              <Form.Label>Username</Form.Label>\n              <Form.Control\n                type=\"text\"\n                placeholder=\"Username\"\n                onChange={handleNameChange}\n              />\n            </Form.Group>\n            <Form.Group controlId=\"formBasicPassword\">\n              <Form.Label>Password</Form.Label>\n              <Form.Control\n                type=\"password\"\n                placeholder=\"Password\"\n                onChange={handlePasswordChange}\n              />\n            </Form.Group>\n          </Form>\n        }\n        control={\n          <Button onClick={login} variant=\"primary\" type=\"submit\">\n            Submit\n          </Button>\n        }\n      />\n    </>\n  );\n};\n\nexport default Login;\n","import React, { useState, useContext } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { Form, Button } from 'react-bootstrap';\nimport Box from '../Box';\nimport { NotificationContext } from '../../context/notification-context';\nimport AuthService from '../../util/auth';\nimport './index.scss';\n\nconst Signup = () => {\n  const [notification, setNotification] = useContext(NotificationContext);\n  const [username, setUsername] = useState('');\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [hasSignup, setHasSignup] = useState(false);\n\n  const signup = (e) => {\n    e.preventDefault();\n    AuthService.signup(username, email, password, ['user'])\n      .then(() => {\n        setHasSignup(true);\n      })\n      .catch((error) => {\n        setNotification({\n          status: error.name,\n          content: error.message,\n        });\n        setTimeout(() => {\n          setNotification({\n            status: null,\n            content: null,\n          });\n        }, 3000);\n      });\n  };\n  const handleNameChange = (e) => {\n    setUsername(e.target.value);\n  };\n  const handleEmailChange = (e) => {\n    setEmail(e.target.value);\n  };\n  const handlePasswordChange = (e) => {\n    setPassword(e.target.value);\n  };\n  if (hasSignup) return <Redirect to=\"login\" />;\n  console.log('process', process.env, notification);\n  return (\n    <Box\n      title=\"Sign Up\"\n      content={\n        <Form>\n          <Form.Group controlId=\"formBasicName\">\n            <Form.Label>Username</Form.Label>\n            <Form.Control\n              type=\"text\"\n              placeholder=\"Normal text\"\n              onChange={handleNameChange}\n              value={username}\n            />\n          </Form.Group>\n          <Form.Group controlId=\"formBasicEmail\">\n            <Form.Label>Email address</Form.Label>\n            <Form.Control\n              type=\"email\"\n              placeholder=\"Enter email\"\n              onChange={handleEmailChange}\n              value={email}\n            />\n          </Form.Group>\n          <Form.Group controlId=\"formBasicPassword\">\n            <Form.Label>Password</Form.Label>\n            <Form.Control\n              type=\"password\"\n              placeholder=\"Password\"\n              onChange={handlePasswordChange}\n              value={password}\n            />\n          </Form.Group>\n        </Form>\n      }\n      control={\n        <Button onClick={signup} variant=\"primary\" type=\"submit\">\n          Sign Up\n        </Button>\n      }\n    />\n  );\n};\n\nexport default Signup;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport AuthService from '../../util/auth';\nimport './index.scss';\n\nconst Home = () => (\n  <div className=\"chat-home\">\n    <h1>Fresh Talk</h1>\n    <div className=\"chat-home__controls\">\n      <Link to=\"/signup\">Sign up</Link>\n      {AuthService.getCurrentUser() ? (\n        <Link to=\"/join\">Join</Link>\n      ) : (\n        <Link to=\"/login\">Login</Link>\n      )}\n    </div>\n  </div>\n);\n\nexport default Home;\n","import React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport { NotificationContext } from '../../context/notification-context';\nimport './index.scss';\n\nconst Head = ({ children }) => {\n  const [notification] = useContext(NotificationContext);\n  console.log('提示', notification);\n  return (\n    <section className=\"chat__head\">\n      <div\n        className={`chat__notification chat__notification${\n          notification.status === 'Error' ? '--active' : ''\n        }`}\n      >\n        {notification.content}\n      </div>\n      <div className=\"chat__head-burgur\">{children}</div>\n    </section>\n  );\n};\n\nHead.propTypes = {\n  children: PropTypes.any,\n}\n\nexport default Head;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Route, Redirect } from 'react-router-dom';\nimport AuthService from '../../util/auth';\n\nconst PrivateRoute = ({ component: Component, location, ...rest }) => (\n  <Route\n    {...rest}\n    render={(props) =>\n      AuthService.getCurrentUser() ? (\n        <Component {...props} />\n      ) : (\n        <Redirect\n          to={{\n            pathname: '/login',\n            state: { from: location },\n          }}\n        />\n      )\n    }\n  />\n);\n\nPrivateRoute.propTypes = {\n  component: PropTypes.Component,\n  location: PropTypes.string,\n}\n\n\nexport default PrivateRoute;\n","import React from 'react';\nimport { withRouter } from 'react-router-dom';\n// import { Button } from 'react-bootstrap';\nimport { BoxArrowLeft } from 'react-bootstrap-icons';\nimport './index.scss';\nimport AuthService from '../../util/auth';\n\n/**\n * withRouter will pass updated match, location,\n * and history props to the wrapped component whenever it renders.\n */\nconst AuthButton = withRouter(\n  ({ history }) =>\n    AuthService.getCurrentUser() && (\n      <BoxArrowLeft\n        size=\"30\"\n        color=\"#fff\"\n        onClick={() => {\n          AuthService.logout();\n          history.push('/');\n        }}\n      >\n        Sign out\n      </BoxArrowLeft>\n    )\n);\n\nexport default AuthButton;\n","import React from 'react';\nimport {\n  BrowserRouter as Router,\n  Route,\n  Redirect,\n  Switch,\n} from 'react-router-dom';\nimport { NotificationContextProvider } from '../src/context/notification-context';\nimport {\n  Home,\n  Head,\n  Login,\n  Signup,\n  AuthButton,\n  Join,\n  Chat,\n  PrivateRoute,\n} from './components';\nimport './index.scss';\n\nconst App = () => (\n  <Router>\n    <NotificationContextProvider>\n      <Head>\n        <AuthButton />\n      </Head>\n      <Switch>\n        <Route path=\"/\" exact component={Home} />\n        <Route path=\"/Signup\" component={Signup} />\n        <Route path=\"/login\" component={Login} />\n        <PrivateRoute path=\"/join\" component={Join} />\n        <PrivateRoute path=\"/chat\" component={Chat} />\n        <Redirect from=\"*\" to=\"/\" />\n      </Switch>\n    </NotificationContextProvider>\n  </Router>\n);\n\nexport default App;\n","import React from 'react';\nimport ReactDom from 'react-dom';\nimport App from './App.js';\n\nReactDom.render(<App />, document.querySelector('#root'));\n"],"sourceRoot":""}