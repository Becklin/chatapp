(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{114:function(e,t,a){e.exports=a(254)},153:function(e,t){},156:function(e,t,a){},157:function(e,t,a){},158:function(e,t,a){},208:function(e,t,a){},209:function(e,t,a){},214:function(e,t){},216:function(e,t){},230:function(e,t,a){},247:function(e,t,a){},249:function(e,t,a){},250:function(e,t,a){},251:function(e,t,a){},252:function(e,t,a){},253:function(e,t,a){},254:function(e,t,a){"use strict";a.r(t);var n,c=a(0),r=a.n(c),o=a(23),l=a.n(o),i=a(8),s=a(6),u=a(57),m=a(7),f=a(99),p=a.n(f),h=a(100),d=a.n(h),g=a(261),E=a(256),b=a(101),v=a(264),y=(a(156),function(e){e.type;var t=e.onHandleFile;return r.a.createElement("div",{className:"button"},r.a.createElement("input",{type:"file",id:"single",accept:"image/*,video/*,audio/*",onChange:function(e){var a=Array.from(e.target.files),n=new FormData;n.append(0,a[0]),t(n.get(0))}}))}),j=(a(157),function(e){var t=e.message,a=e.setMessage,n=e.sendMessage,c=e.sendFile,o=e.uploadFile;return r.a.createElement("form",{className:"chat__form"},r.a.createElement(E.a,null,r.a.createElement(b.a,{xs:8},r.a.createElement("input",{className:"chat__input",value:t,onChange:function(e){return a(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?a(e.target.value):null}})),r.a.createElement(b.a,{xs:4},r.a.createElement(v.a,{disabled:!t,size:"sm",onClick:function(e){return n(e)}},"send"),r.a.createElement(y,{size:"sm",type:"sendFile",onHandleFile:c},"Files"),r.a.createElement(y,{size:"sm",type:"upload",onHandleFile:o},"Files"))))}),O=a(257),w=a(258),_=(a(158),r.a.memo((function(e){var t=e.room,a=e.counts;return r.a.createElement(E.a,{className:"chat__infoBar"},r.a.createElement(b.a,{xs:7},r.a.createElement("h3",null,t)),r.a.createElement(b.a,{xs:3},a," ",r.a.createElement(O.a,{color:"#ffffff",size:24})),r.a.createElement(b.a,{xs:2},r.a.createElement(i.b,{to:"/"},r.a.createElement(w.a,{color:"white",size:24}))))}))),S=a(103),k=a.n(S),C=a(259),F=a(260),N=a(104),x=a.n(N),A=(a(208),function(e){var t=e.message,a=t.user,n=t.text,c=t.upload,o=t.type,l=t.address,i=e.name,s=e.avatarSrc,u=!1,m=i.trim().toLowerCase();m===a&&(u=!0);var f=u?"user":"friend",p="user"===f?m:a;return r.a.createElement("div",{className:"chat-message__wrapper"},r.a.createElement("div",{className:"chat-message__userInfo chat-message__userInfo--".concat(f)},r.a.createElement("span",{className:"chat-message__avatar"},s?r.a.createElement(C.a,{src:s,roundedCircle:!0}):r.a.createElement(F.a,{size:24})),r.a.createElement("span",null,p),r.a.createElement("div",{className:"chat-message__content chat-message__content--".concat(f)},function(e,t){if(e)return r.a.createElement("div",{dangerouslySetInnerHTML:{__html:e}});if(t)switch(t){case"video/mp4":case"video/quicktime":return r.a.createElement("video",{controls:!0},r.a.createElement("source",{src:"data:image/png;base64, ".concat(c),type:"video/mp4"}),r.a.createElement("source",{src:"data:image/png;base64, ".concat(c),type:"video/ogg"}),"Your browser does not support the video tag.");case"image/*":default:return r.a.createElement("img",{className:"img-thumbnail img-fluid",src:"data:image/png;base64, ".concat(c)})}return r.a.createElement("p",{className:"chat-message__content--text"},x.a.emojify(n))}(l,o))))}),z=(a(209),r.a.memo((function(e){var t=e.messages,a=e.name;return r.a.createElement(k.a,{className:"chat__messages"},t.map((function(e,t){return r.a.createElement(A,{key:"name-".concat(t),message:e,name:a})})))}))),D=a(105),I=a(106),L=a(13),P=a.n(L),B=function(){function e(t,a,n){Object(D.a)(this,e),this.socket=a,this.file=t,this.name=t.name}return Object(I.a)(e,[{key:"send",value:function(){var e=P.a.createStream();P()(this.socket).emit("sendFile",e,{name:this.file.name,type:this.file.type,size:this.file.size});P.a.createBlobReadStream(this.file).pipe(e)}},{key:"upload",value:function(){var e=P.a.createStream();P()(this.socket).emit("uploadFile",e,{name:this.file.name,type:this.file.type,size:this.file.size});P.a.createBlobReadStream(this.file).pipe(e)}}],[{key:"process",value:function(t,a){var n=this,c={name:t.name,quality:.6};return q(t,c).then((function(e){var t=e.readerData,a=e.config,c=e.callback;return n.base64=t,M(t,a,c)})).then((function(e){var t=e.base64,a=e.config,c=e.callback;return n.minifiedBase64=t,R(t,a,c)})).then((function(t){return n.minifiedFile=t,new e(n.minifiedFile,a)}))}}]),e}(),q=function(e,t,a){return console.log("\u958b\u59cb",e),new Promise((function(n){var c=new FileReader;c.readAsDataURL(e),c.onload=function(){var e=this.result;n({readerData:e,config:t,callback:a})},c.onloadend=function(){console.log("\u52a0\u8f09\u5df2\u7d93\u7d50\u675f")}}))},M=function(e,t,a){return new Promise((function(n){var c=new Image;c.src=e,c.onload=function(){var e=400/(c.width/c.height),r=.7,o=document.createElement("canvas"),l=o.getContext("2d"),i=document.createAttribute("width");i.nodeValue=400;var s=document.createAttribute("height");s.nodeValue=e,o.setAttributeNode(i),o.setAttributeNode(s),l.drawImage(c,0,0,400,e),t.quality&&t.quality<=1&&t.quality>0&&(r=t.quality);var u=o.toDataURL("image/jpeg","image/webp",r);n({base64:u,config:t,callback:a})}}))},R=function(e,t){for(var a=e.split(","),n=a[0].match(/:(.*?);/)[1],c=atob(a[1]),r=c.length,o=new Uint8Array(r);r--;)o[r]=c.charCodeAt(r);return new File([o],t.name,{type:n})},U=B,H=function(){var e=Object(s.g)().search,t=Object(c.useState)(""),a=Object(m.a)(t,2),o=a[0],l=a[1],i=Object(c.useState)(""),f=Object(m.a)(i,2),h=f[0],E=f[1],b=Object(c.useState)(""),v=Object(m.a)(b,2),y=v[0],O=v[1],w=Object(c.useState)([]),S=Object(m.a)(w,2),k=S[0],C=S[1],F=Object(c.useState)(0),N=Object(m.a)(F,2),x=N[0],A=N[1],D="".concat("https://cors-anywhere.herokuapp.com/","https://dailyeasychat.herokuapp.com");Object(c.useEffect)((function(){var t=p.a.parse(e),a=t.name,c=t.room;return n=d()(D),l(a),E(c),n.emit("join",{name:a,room:c},(function(e){e&&alert(e)})),function(){n.emit("disconnect"),n.off()}}),[D,e]),Object(c.useEffect)((function(){n.on("message",(function(e){C((function(t){return[].concat(Object(u.a)(t),[e])}))})),n.on("file",(function(e){var t=e.user,a=e.upload,n=e.type;a&&C((function(e){return[].concat(Object(u.a)(e),[{user:t,upload:a,type:n}])}))}))}),[]),Object(c.useEffect)((function(){n.on("roomData",(function(e){var t=e.users;A(t.length)}))}),[x]);return r.a.createElement(g.a,{fluid:!0},r.a.createElement(_,{room:h,counts:x}),r.a.createElement(z,{messages:k,name:o}),r.a.createElement(j,{message:y,setMessage:O,sendMessage:function(e){e.preventDefault(),y&&n.emit("sendMessage",y,(function(){return O("")}))},sendFile:function(e){U.process(e,n).then((function(e){e.send()}))},uploadFile:function(e){U.process(e,n).then((function(e){e.upload()}))}}))},J=(a(230),function(){var e=Object(c.useState)(""),t=Object(m.a)(e,2),a=t[0],n=t[1],o=Object(c.useState)(""),l=Object(m.a)(o,2),s=l[0],u=l[1];return r.a.createElement(g.a,{className:"join__wrapper"},r.a.createElement("h1",null,"Join"),r.a.createElement("input",{className:"chat__input",placeholder:"name",onChange:function(e){return n(e.target.value)}}),r.a.createElement("input",{className:"chat__input",placeholder:"room",onChange:function(e){return u(e.target.value)}}),r.a.createElement(i.b,{onClick:function(e){return a&&s?null:e.preventDefault()},to:"/chat?name=".concat(a,"&room=").concat(s)},r.a.createElement(v.a,{block:!0,type:"submit"},"Join In")))}),G=a(262),T={isAuthenticated:!1,authenticate:function(e){this.isAuthenticated=!0,e()},signout:function(e){this.isAuthenticated=!1,e()}},V=a(38),W=a.n(V),Y=(a(247),function(e){var t=Object(c.useState)(!1),a=Object(m.a)(t,2),n=a[0],o=a[1],l=Object(c.useState)(""),i=Object(m.a)(l,2),u=i[0],f=i[1],p=Object(c.useState)(""),h=Object(m.a)(p,2),d=h[0],g=h[1];(e.location.state||{from:{pathname:"/"}}).from;if(!0===n)return r.a.createElement(s.a,{to:"join"});return r.a.createElement(G.a,null,r.a.createElement(G.a.Control,{type:"text",placeholder:"Username",onChange:function(e){f(e.target.value)}}),r.a.createElement(G.a.Group,{controlId:"formBasicPassword"},r.a.createElement(G.a.Label,null,"Password"),r.a.createElement(G.a.Control,{type:"password",placeholder:"Password",onChange:function(e){g(e.target.value)}})),r.a.createElement(v.a,{onClick:function(e){e.preventDefault(),W.a.post("https://dailyeasychat.herokuapp.com/api/auth/signin",{username:u,password:d}).then((function(e){T.authenticate((function(){o(!0)}))})).catch((function(e){console.log("catch",e)}))},variant:"primary",type:"submit"},"Submit"))}),K=a(263),Q=(a(249),function(e){var t=Object(c.useState)(""),a=Object(m.a)(t,2),n=a[0],o=a[1],l=Object(c.useState)(""),i=Object(m.a)(l,2),u=i[0],f=i[1],p=Object(c.useState)(""),h=Object(m.a)(p,2),d=h[0],g=h[1],E=Object(c.useState)(!1),b=Object(m.a)(E,2),y=b[0],j=b[1],O=Object(c.useState)(!1),w=Object(m.a)(O,2),_=w[0],S=w[1];return y?r.a.createElement(s.a,{to:"login"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(G.a,null,r.a.createElement(G.a.Control,{type:"text",placeholder:"Normal text",onChange:function(e){o(e.target.value)},value:n}),r.a.createElement(G.a.Group,{controlId:"formBasicEmail"},r.a.createElement(G.a.Label,null,"Email address"),r.a.createElement(G.a.Control,{type:"email",placeholder:"Enter email",onChange:function(e){f(e.target.value)},value:u}),r.a.createElement(G.a.Text,{className:"text-muted"},"We'll never share your email with anyone else.")),r.a.createElement(G.a.Group,{controlId:"formBasicPassword"},r.a.createElement(G.a.Label,null,"Password"),r.a.createElement(G.a.Control,{type:"password",placeholder:"Password",onChange:function(e){g(e.target.value)},value:d})),r.a.createElement(v.a,{onClick:function(e){e.preventDefault();W.a.post("".concat("https://cors-anywhere.herokuapp.com/","https://dailyeasychat.herokuapp.com/api/auth/signup"),{username:n,email:u,password:d,roles:["user"]}).then((function(e){j(!0)})).catch((function(e){console.log("catch",e),S(!0)}))},variant:"primary",type:"submit"},"Sign Up")),r.a.createElement(K.a,{onClose:function(){return S(!1)},show:_,autohide:!0},r.a.createElement(K.a.Header,null,r.a.createElement("img",{src:"holder.js/20x20?text=%20",className:"rounded mr-2",alt:""}),r.a.createElement("strong",{className:"mr-auto"},"FAILURE"),r.a.createElement("small",null,"11 mins ago")),r.a.createElement(K.a.Body,null,"Oops, something went wrong !")))}),X=(a(250),function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Welcome to EazyChat"),r.a.createElement(i.b,{to:"/signup"},"Sign up"),r.a.createElement(i.b,{to:"/login"},"Login"))}),Z=(a(251),function(e){var t=e.children;return r.a.createElement(r.a.Fragment,null,t)}),$=a(111),ee=function(e){var t=e.component,a=Object($.a)(e,["component"]);return r.a.createElement(s.b,Object.assign({},a,{render:function(e){return!0===T.isAuthenticated?r.a.createElement(t,e):r.a.createElement(s.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},te=(a(252),Object(s.h)((function(e){var t=e.history;return T.isAuthenticated?r.a.createElement(v.a,{onClick:function(){T.signout((function(){return t.push("/")}))}},"Sign out"):r.a.createElement("p",null,"You are not logged in.")}))),ae=(a(253),function(){return r.a.createElement(i.a,null,r.a.createElement(Z,null,r.a.createElement(te,null)),r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/",exact:!0,component:X}),r.a.createElement(s.b,{path:"/Signup",component:Q}),r.a.createElement(s.b,{path:"/login",component:Y}),r.a.createElement(ee,{path:"/join",component:J}),r.a.createElement(ee,{path:"/chat",component:H}),r.a.createElement(s.a,{from:"*",to:"/"})))});l.a.render(r.a.createElement(ae,null),document.querySelector("#root"))}},[[114,1,2]]]);
//# sourceMappingURL=main.27519916.chunk.js.map