{"version":3,"sources":["context/notification-context.js","components/IconButton/index.js","components/Input/index.js","components/InfoBar/index.js","components/Message/index.js","components/Messages/index.js","util/FileConverter.js","components/Chat/index.js","util/FileProcessor.js","components/Box/index.js","components/Join/index.js","util/auth.js","components/Login/index.js","components/Signup/index.js","components/Home/index.js","components/Head/index.js","components/PrivateRoute/index.js","components/AuthButton/index.js","App.js","index.js"],"names":["NotificationContext","createContext","NotificationContextProvider","props","useState","notification","setNotification","Provider","value","children","IconButton","onHandleClick","className","name","disabled","icon","iconName","htmlFor","type","id","accept","onChange","e","files","Array","from","target","formData","FormData","append","get","Input","message","setMessage","sendMessage","sendFile","uploadFile","console","log","placeholder","event","onKeyPress","key","size","onClick","color","React","memo","room","counts","to","Message","user","content","upload","address","percent","date","avatarSrc","isSentByCurrentUser","trimmedName","trim","toLowerCase","role","title","src","roundedCircle","ProgressBar","now","animated","renderProgress","moment","format","dangerouslySetInnerHTML","__html","width","controls","renderFile","ReactEmoji","emojify","messages","rest","map","dataURLtoFile","base64","config","callback","arr","split","mime","match","bstr","atob","n","length","u8arr","Uint8Array","charCodeAt","File","socket","FileProcessor","file","this","stream","ss","createStream","createBlobReadStream","pipe","emit","quality","convertToDataUrl","then","readerDataUrl","Promise","resolve","alert","data","a","addImageProcess","reject","reader","FileReader","readAsDataURL","onload","result","onerror","onloadend","Chat","search","useLocation","setName","setRoom","setMessages","setCounts","ENDPOINT","useEffect","qs","parse","io","path","transports","secure","error","off","getMessage","element","on","amount","messageIndex","findIndex","addMessage","index","payload","updateMessage","users","preventDefault","process","minifiedFileProcessor","send","originalFileProcessor","Box","control","defaultProps","setHasNotification","hasNotification","Join","avatar","setAvatar","Form","URL","createObjectURL","Group","controlId","Label","Control","Button","block","API_URL","username","password","axios","post","response","accessToken","localStorage","setItem","JSON","stringify","removeItem","email","getItem","Login","useContext","redirectToReferrer","setRedirectToReferrer","setUsername","setPassword","AuthService","login","catch","status","setTimeout","variant","Signup","setEmail","hasSignup","setHasSignup","signup","Home","getCurrentUser","Head","PrivateRoute","Component","component","render","pathname","state","location","AuthButton","withRouter","history","logout","push","App","exact","ReactDom","document","querySelector"],"mappings":"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","file":"static/js/main.46d5087d.chunk.js","sourcesContent":["import React, { useState, createContext } from 'react';\n\n// Create Context Object\nexport const NotificationContext = createContext();\n\n// Create a provider for components to consume and subscribe to changes\nexport const NotificationContextProvider = (props) => {\n  const [notification, setNotification] = useState({});\n\n  return (\n    <NotificationContext.Provider value={[notification, setNotification]}>\n      {props.children}\n    </NotificationContext.Provider>\n  );\n};\n","import React from 'react';\nimport './index.scss';\n\n//USER送發訊息的人，name該聊天室使用者名字\nconst IconButton = ({ onHandleClick, className, name, disabled, icon }) => {\n  const onChange = (e) => {\n    const files = Array.from(e.target.files);\n    let formData = new FormData();\n    formData.append(0, files[0]);\n    onHandleClick(formData.get(0));\n  };\n  const iconName = `icon-${name}`;\n  return (\n    <span className={`chat__icon ${className} ${disabled ? 'disabled' : ''}`}>\n      <label className=\"chat__label\" htmlFor={iconName}>\n        {icon && icon}\n      </label>\n      <input\n        className=\"hidden-input\"\n        type=\"file\"\n        name={iconName}\n        id={iconName}\n        accept=\"image/*,video/*,audio/*\"\n        onChange={onChange}\n      />\n    </span>\n  );\n};\n\nexport default IconButton;\n","import React from 'react';\n// import { Row, Col, Button } from 'react-bootstrap';\nimport { ChatTextFill, CloudUploadFill, Image } from 'react-bootstrap-icons';\nimport IconButton from '../IconButton';\nimport './index.scss';\n\nconst Input = ({\n  message = '',\n  setMessage,\n  sendMessage,\n  sendFile,\n  uploadFile,\n}) => {\n  const handleSendMessage = (event) => {\n    sendMessage(event);\n  };\n  console.log('信息', message);\n  return (\n    <form className=\"chat__form\">\n      <textarea\n        className=\"chat__message\"\n        placeholder=\"write some message...\"\n        value={message}\n        onChange={(event) => setMessage(event.target.value)}\n        onKeyPress={(event) =>\n          event.key === 'Enter' ? setMessage(event.target.value) : null\n        }\n      />\n      <div className=\"chat__controls\">\n        <IconButton\n          disabled={message}\n          className=\"chat__flex\"\n          type=\"file\"\n          onHandleClick={sendFile}\n          icon={<Image />}\n          name=\"files\"\n        />\n        <IconButton\n          disabled={message}\n          className=\"chat__flex\"\n          type=\"file\"\n          onHandleClick={uploadFile}\n          icon={<CloudUploadFill />}\n          name=\"upload\"\n        />\n        <ChatTextFill\n          className=\"chat__flex\"\n          size=\"32\"\n          onClick={message ? handleSendMessage : null}\n          color={message ? 'darkslategray' : '#e3e3e3'}\n        />\n      </div>\n    </form>\n  );\n};\nexport default Input;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\n// import { Row, Col } from 'react-bootstrap';\nimport { ArrowLeftCircle, PeopleFill } from 'react-bootstrap-icons';\nimport './index.scss';\n\nconst InfoBar = ({ room, counts }) => (\n  <div className=\"chat__infoBar\">\n    <div className=\"chat__room\">\n      <h3>{room}</h3>\n    </div>\n    <div className=\"chat__count\">\n      {counts} <PeopleFill color=\"#ffffff\" size={24} />\n    </div>\n    <div className=\"chat__back\">\n      <Link to=\"/\">\n        <ArrowLeftCircle color=\"white\" size={24} />\n      </Link>\n    </div>\n  </div>\n);\n\nexport default React.memo(InfoBar);\n","import React from 'react';\nimport { Image, ProgressBar } from 'react-bootstrap';\nimport { PersonCircle } from 'react-bootstrap-icons';\nimport ReactEmoji from 'react-emoji';\nimport moment from 'moment';\nimport './index.scss';\n\n//USER送發訊息的人，name該聊天室使用者名字\nconst Message = ({\n  message,\n  message: { user, content, upload, type, address, percent, date },\n  name,\n  avatarSrc,\n}) => {\n  // console.log('最後', user, content, message);\n  let isSentByCurrentUser = false;\n  const trimmedName = name.trim().toLowerCase();\n  if (trimmedName === user) isSentByCurrentUser = true;\n  const role = isSentByCurrentUser ? 'user' : 'friend';\n  const title = role === 'user' ? trimmedName : user;\n  const renderProgress = (percent) => {\n    if (percent > 0 && percent < 100)\n      return (\n        <>\n          loading...\n          <ProgressBar now={percent} animated />\n        </>\n      );\n  };\n\n  const renderFile = ({ address, type, upload }) => {\n    if (address) return <div dangerouslySetInnerHTML={{ __html: address }} />;\n    if (type && upload) {\n      switch (type) {\n        case 'video/mp4': {\n          return (\n            <video width=\"100%\" controls>\n              <source\n                src={`data:image/png;base64, ${upload}`}\n                type=\"video/mp4\"\n              />\n              <source\n                src={`data:image/png;base64, ${upload}`}\n                type=\"video/ogg\"\n              />\n              Your browser does not support the video tag.\n            </video>\n          );\n          break;\n        }\n        case 'image/*':\n          return (\n            <img\n              className=\"img-thumbnail img-fluid\"\n              src={`data:image/png;base64, ${upload}`}\n            />\n          );\n          break;\n        default:\n          return (\n            <img\n              className=\"img-thumbnail img-fluid\"\n              src={`data:image/png;base64, ${upload}`}\n            />\n          );\n      }\n    }\n  };\n\n  return (\n    <div className={`chat-message chat-message--${role}`}>\n      {role === 'friend' && (\n        <h4>\n          {avatarSrc ? (\n            <Image src={avatarSrc} roundedCircle />\n          ) : (\n            <PersonCircle size={24} />\n          )}\n          <span>{title}</span>\n        </h4>\n      )}\n      <div className=\"chat-message__body\">\n        {renderProgress(percent)}\n        <span className=\"chat-message__date\">{moment(date).format('LTS')}</span>\n        {renderFile({ address, percent, type, upload })}\n        {content && (\n          <p className=\"chat-message__body--text\">\n            {ReactEmoji.emojify(content)}\n          </p>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Message;\n","import React from 'react';\nimport ScrollToBottom from 'react-scroll-to-bottom';\nimport Message from '../Message';\nimport './index.scss';\n\nconst Messages = ({ messages, name, ...rest }) => (\n  <ScrollToBottom className=\"chat__messages\">\n    {messages.map((message) => {\n      return (\n        <Message\n          key={`name-${message.id}`}\n          message={message}\n          name={name}\n          {...rest}\n        />\n      );\n    })}\n  </ScrollToBottom>\n);\n\nexport default React.memo(Messages);\n","export function dataURLtoFile(base64, config, callback) {\n  var arr = base64.split(','),\n    mime = arr[0].match(/:(.*?);/)[1],\n    bstr = atob(arr[1]),\n    n = bstr.length,\n    u8arr = new Uint8Array(n);\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n);\n  }\n  return new File([u8arr], config.name, { type: mime });\n}\n\nexport function minifiedDataURL(readerDataUrl, config, callback) {\n  return new Promise((resolve) => {\n    // let video = document.createElement('video');\n    // video.setAttribute('src', readerDataUrl);\n    let img = new Image();\n    // 要從這裡讀取到type\n    img.src = readerDataUrl;\n    img.onload = () => {\n      // var that = this;\n      // 預設按比例壓縮\n      let width = img.width,\n        height = img.height,\n        scale = width / height;\n      const resizedWidth = 400;\n      let resizedHeight = resizedWidth / scale;\n      let quality = 0.7; // 預設圖片質量為0.7\n      //生成canvas\n      // 關鍵字\n      let canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n      // 建立屬性節點\n      const anw = document.createAttribute('width');\n      anw.nodeValue = resizedWidth;\n      const anh = document.createAttribute('height');\n      anh.nodeValue = resizedHeight;\n      canvas.setAttributeNode(anw);\n      canvas.setAttributeNode(anh);\n      ctx.drawImage(img, 0, 0, resizedWidth, resizedHeight);\n      // 影象質量\n      if (config.quality && config.quality <= 1 && config.quality > 0) {\n        quality = config.quality;\n      }\n      /*\n          我們只需要把<img>獲取到的圖片放到<canvas>裡再通過.toDataURL()方法轉化下，\n          就可以得到以 base64 編碼的 dataURL。來看這個方法的語法： \n          */\n      var base64 = canvas.toDataURL('image/jpeg', 'image/webp', quality);\n      const newFile = dataURLtoFile(base64, config, callback);\n      resolve(newFile);\n    };\n  });\n}\n","import React, { useState, useEffect } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport qs from 'query-string';\nimport io from 'socket.io-client';\n// import { Container } from 'react-bootstrap';\nimport Input from '../Input';\nimport InfoBar from '../InfoBar';\nimport Messages from '../Messages';\nimport FileProcessor from '../../util/FileProcessor';\n\nlet socket;\n\nconst Chat = () => {\n  let { search } = useLocation();\n  const [name, setName] = useState('');\n  const [room, setRoom] = useState('');\n  const [message, setMessage] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [counts, setCounts] = useState(0);\n\n  let ENDPOINT = 'localhost:5000';\n  if (process.env.NODE_ENV === 'production') {\n    ENDPOINT = 'https://dailytalk.herokuapp.com';\n  }\n  console.log(ENDPOINT);\n  useEffect(() => {\n    const { name, room } = qs.parse(search);\n    socket = io(ENDPOINT, {\n      path: '/socket.io',\n      transports: ['websocket'],\n      secure: true,\n    });\n    setName(name);\n    setRoom(room);\n\n    socket.emit('join', { name, room }, (error) => {\n      if (error) {\n        alert(error);\n      }\n    });\n\n    return () => {\n      socket.emit('disconnect');\n      socket.off();\n    };\n  }, [ENDPOINT, search]);\n\n  useEffect(() => {\n    const getMessage = (element, id) => element.id === id;\n    const addMessage = ({ messages, id, upload = '', user, type, percent }) => {\n      return [\n        ...messages,\n        {\n          id,\n          upload,\n          user,\n          type,\n          percent,\n        },\n      ];\n    };\n    const updateMessage = (index, messages, payload) => {\n      messages[index] = {\n        ...messages[index],\n        ...payload,\n      };\n      return [...messages];\n    };\n    socket.on('message', (message) =>\n      setMessages((messages) => {\n        return [...messages, message];\n      })\n    );\n    socket.on('percent', (amount, { id, user, type }) => {\n      setMessages((messages) => {\n        const messageIndex = messages.findIndex((message) =>\n          getMessage(message, id)\n        );\n        if (messageIndex < 0) {\n          const config = {\n            messages,\n            id,\n            percent: amount,\n            user,\n            type,\n          };\n          return addMessage(config);\n        } else {\n          messages[messageIndex].percent = amount;\n          return [...messages];\n        }\n      });\n    });\n    socket.on('file', ({ user, upload, type, id }) => {\n      if (upload) {\n        setMessages((messages) => {\n          const messageIndex = messages.findIndex((message) =>\n            getMessage(message, id)\n          );\n          const payload = {\n            id,\n            user,\n            upload,\n            type,\n          };\n          return updateMessage(messageIndex, messages, payload);\n        });\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    socket.on('roomData', ({ users }) => {\n      setCounts(users.length);\n    });\n  }, [counts]);\n\n  const sendMessage = (event) => {\n    event.preventDefault();\n    if (message) {\n      socket.emit('sendMessage', message, () => setMessage(''));\n    }\n  };\n\n  const sendFile = (file) => {\n    /* build => 非同步promise處裡檔案 */\n    FileProcessor.process(file, socket).then((minifiedFileProcessor) => {\n      minifiedFileProcessor.send();\n    });\n  };\n\n  const uploadFile = (file) => {\n    FileProcessor.process(file, socket).then((originalFileProcessor) =>\n      originalFileProcessor.upload()\n    );\n  };\n\n  return (\n    <>\n      <InfoBar room={room} counts={counts} />\n      <Messages messages={messages} name={name} />\n      <Input\n        message={message}\n        setMessage={setMessage}\n        sendMessage={sendMessage}\n        sendFile={sendFile}\n        uploadFile={uploadFile}\n      />\n    </>\n  );\n};\n\nexport default Chat;\n","import ss from 'socket.io-stream';\nimport { dataURLtoFile } from './FileConverter';\n\nclass FileProcessor {\n  constructor(file, socket, callback) {\n    console.log('檔案', file);\n\n    this.socket = socket;\n    this.file = file;\n    this.name = file.name;\n  }\n  static process(file, socket) {\n    const config = {\n      name: file.name,\n      quality: 0.6,\n      type: file.type\n    };\n    return convertToDataUrl(file, config)\n      .then(({ readerDataUrl, config, callback }) => {\n        this.base64 = readerDataUrl;\n        console.log('轉換成convertToDataUrl');\n        switch (config.type) {\n          // case 'image/jpeg': {\n          //   return minifiedDataURL(readerDataUrl, config, callback);\n          // }\n          case 'image/jpeg':\n          case 'video/mp4': {\n            return new Promise(resolve => {\n              const newFile = dataURLtoFile(readerDataUrl, config, callback);\n              resolve(newFile);\n            });\n          }\n          default: {\n            alert('the type is not supprted');\n          }\n        }\n      })\n      .then(data => {\n        this.data = data;\n        return new FileProcessor(this.data, socket);\n      });\n  }\n  send() {\n    console.log('送出', this, this.file.size);\n\n    const stream = ss.createStream();\n    const blobStream = ss.createBlobReadStream(this.file); //for browser use, 本來寫法是什麼\n    blobStream.pipe(stream);\n\n    ss(this.socket).emit('sendFile', stream, {\n      name: this.file.name,\n      type: this.file.type,\n      size: this.file.size\n    });\n    console.log('this.file', this.file);\n    // const totalSize = this.file.size;\n    // let size = 0;\n    // blobStream.on('data', function (chunk) {\n    //   size += chunk.length;\n    //   console.log('totalSize', totalSize);\n    //   console.log(Math.floor((size / totalSize) * 100) + '%');\n    // });\n    // console.log('完成Blob', Date());\n  }\n\n  upload() {\n    const stream = ss.createStream();\n    ss(this.socket).emit('uploadFile', stream, {\n      name: this.file.name,\n      type: this.file.type,\n      size: this.file.size\n    });\n    const blobStream = ss.createBlobReadStream(this.file); //for browser use, 本來寫法是什麼\n    // let size = 0;\n    // blobStream.on('data', function(chunk) {\n    //   size += chunk.length;\n    //   console.log(Math.floor((size / file.size) * 100) + '%');\n    // });\n    blobStream.pipe(stream);\n  }\n}\nconst convertToDataUrl = async (file, config, callback) => {\n  // 王牌文件 https://kknews.cc/zh-tw/code/e6p2ygq.html\n  // 神文 https://codertw.com/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/227679/\n  /* 使用FileReader對象分三步走： 一 創建FileReader實例 */\n  // var reader = new FileReader();\n  /* 開始讀取指定的Blob物件或File物件中的內容. 當讀取操作完成時,readyState屬性的值會成為DONE,\n    如果設定了onloadend事件處理程式,則呼叫之.\n    同時,result屬性中將包含一個data: URL格式的字串以表示所讀取檔案的內容.\n  */\n\n  /* 讀取Blob或者File對象的數據內容 */\n  // reader.readAsDataURL(file); // 讀取文件內容，結果用data:url的字符串形式表示\n\n  // reader.onloadstart = function() {\n  //   console.log('加載已經開始');\n  // };\n  // reader.onprogress = function(what) {\n  //   console.log('啥', what); //注意必包\n  // };\n  /** 設置回調函數，這裡以讀取成功的回調函數為例： */\n  const addImageProcess = (file, config, callback) => {\n    return new Promise((resolve, reject) => {\n      var reader = new FileReader();\n      reader.readAsDataURL(file); // 讀取文件內容，結果用data:url的字符串形式表示\n      reader.onload = function() {\n        const readerDataUrl = this.result;\n        console.log('加載開始');\n        resolve({ readerDataUrl, config, callback });\n      };\n      reader.onerror = () => reject('加载失败');\n      reader.onloadend = function() {\n        console.log('加載已經結束');\n      };\n    });\n  };\n  return await addImageProcess(file, config, callback);\n};\n\n// const convertToDataUrl2 = (file, config, callback) => {\n//   return new Promise(resolve => {\n//     // 王牌文件 https://kknews.cc/zh-tw/code/e6p2ygq.html\n//     // 神文 https://codertw.com/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/227679/\n//     /* 使用FileReader對象分三步走： 一 創建FileReader實例 */\n//     var reader = new FileReader();\n//     /* 開始讀取指定的Blob物件或File物件中的內容. 當讀取操作完成時,readyState屬性的值會成為DONE,\n//     如果設定了onloadend事件處理程式,則呼叫之.\n//     同時,result屬性中將包含一個data: URL格式的字串以表示所讀取檔案的內容.\n//   */\n\n//     /* 讀取Blob或者File對象的數據內容 */\n//     reader.readAsDataURL(file); // 讀取文件內容，結果用data:url的字符串形式表示\n\n//     // reader.onloadstart = function() {\n//     //   console.log('加載已經開始');\n//     // };\n//     // reader.onprogress = function(what) {\n//     //   console.log('啥', what); //注意必包\n//     // };\n//     /** 設置回調函數，這裡以讀取成功的回調函數為例： */\n//     reader.onload = function() {\n//       const readerDataUrl = this.result;\n//       console.log('加載開始');\n\n//       resolve({ readerDataUrl, config, callback });\n//     };\n//     reader.onloadend = function() {\n//       console.log('加載已經結束');\n//     };\n//   });\n// };\n\nexport default FileProcessor;\n","import React from 'react';\n// import PropTypes from 'prop-types';\nimport './index.scss';\n// import useMediaQuery from '../../util/useMediaQuery';\n\nconst Box = ({ title, content, control }) => {\n  // const mediaQuery = useMediaQuery();\n  return (\n    <div className=\"chat__box\">\n      <h1>{title}</h1>\n      {content}\n      <div>{control}</div>\n    </div>\n  );\n};\n\nBox.defaultProps = {\n  setHasNotification: () => {},\n  hasNotification: false,\n};\n\nexport default Box;\n","import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport Box from '../Box';\nimport { Button, Form } from 'react-bootstrap';\nimport './index.scss';\n\nconst Join = () => {\n  const [name, setName] = useState('');\n  const [room, setRoom] = useState('');\n  const [avatar, setAvatar] = useState();\n  const handleChange = (event) => {\n    setAvatar(URL.createObjectURL(event.target.files[0]));\n  };\n  return (\n    <Box\n      title=\"Join\"\n      content={\n        <Form>\n          <input type=\"file\" onChange={handleChange} />\n          <img width=\"50px\" src={avatar} />\n          <Form.Group controlId=\"formBasicPassword\">\n            <Form.Label>Username</Form.Label>\n            <Form.Control\n              type=\"text\"\n              placeholder=\"Username\"\n              onChange={(e) => setName(e.target.value)}\n            />\n            <Form.Label>Room</Form.Label>\n            <Form.Control\n              type=\"text\"\n              placeholder=\"Room\"\n              onChange={(e) => setRoom(e.target.value)}\n            />\n          </Form.Group>\n        </Form>\n      }\n      control={\n        <Link\n          onClick={(event) => (!name || !room ? event.preventDefault() : null)}\n          to={`/chat?name=${name}&room=${room}`}\n        >\n          <Button block type=\"submit\">\n            Join In\n          </Button>\n        </Link>\n      }\n    />\n  );\n};\n\nexport default Join;\n","import axios from 'axios';\n\nlet API_URL = '/api/auth/';\nif (process.env.NODE_ENV === 'production') {\n  API_URL = 'https://dailytalk.herokuapp.com/api/auth/';\n}\nconsole.log(API_URL);\nclass AuthService {\n  login(username, password) {\n    return axios\n      .post(API_URL + 'signin', {\n        username,\n        password\n      })\n      .then(response => {\n        if (response.data.accessToken) {\n          localStorage.setItem('user', JSON.stringify(response.data));\n        }\n        return response.data;\n      });\n  }\n\n  logout() {\n    localStorage.removeItem('user');\n  }\n\n  signup(username, email, password) {\n    console.log(username, email, password);\n    return axios.post(API_URL + 'signup', {\n      username,\n      email,\n      password\n    });\n  }\n\n  getCurrentUser() {\n    return JSON.parse(localStorage.getItem('user'));\n  }\n}\n\nexport default new AuthService();\n","import React, { useState, useContext } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { Form, Button } from 'react-bootstrap';\n\nimport Box from '../Box';\nimport { NotificationContext } from '../../context/notification-context';\nimport AuthService from '../../util/auth';\nimport './index.scss';\n\nconst Login = (props) => {\n  const [notification, setNotification] = useContext(NotificationContext);\n  const [redirectToReferrer, setRedirectToReferrer] = useState(false);\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const login = (e) => {\n    e.preventDefault();\n    AuthService.login(username, password)\n      .then((response) => {\n        // 以驗證mongodb data以及設定localstorage\n        setRedirectToReferrer(true);\n      })\n      .catch((error) => {\n        setNotification({\n          status: error.name,\n          content: error.message,\n        });\n        setTimeout(() => {\n          setNotification({\n            status: null,\n            content: null,\n          });\n        }, 3000);\n      });\n  };\n  // const { from } = props.location.state || { from: { pathname: '/' } };\n  if (redirectToReferrer === true) {\n    return <Redirect to=\"join\" />;\n  }\n  const handleNameChange = (e) => {\n    setUsername(e.target.value);\n  };\n  const handlePasswordChange = (e) => {\n    setPassword(e.target.value);\n  };\n  return (\n    <>\n      <Box\n        title=\"Login\"\n        content={\n          <Form>\n            <Form.Group controlId=\"formBasicName\">\n              <Form.Label>Username</Form.Label>\n              <Form.Control\n                type=\"text\"\n                placeholder=\"Username\"\n                onChange={handleNameChange}\n              />\n            </Form.Group>\n            <Form.Group controlId=\"formBasicPassword\">\n              <Form.Label>Password</Form.Label>\n              <Form.Control\n                type=\"password\"\n                placeholder=\"Password\"\n                onChange={handlePasswordChange}\n              />\n            </Form.Group>\n          </Form>\n        }\n        control={\n          <Button onClick={login} variant=\"primary\" type=\"submit\">\n            Submit\n          </Button>\n        }\n      />\n    </>\n  );\n};\n\nexport default Login;\n","import React, { useState, useContext } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { Form, Button } from 'react-bootstrap';\nimport Box from '../Box';\nimport { NotificationContext } from '../../context/notification-context';\nimport AuthService from '../../util/auth';\nimport './index.scss';\n\nconst Signup = (props) => {\n  const [notification, setNotification] = useContext(NotificationContext);\n  const [username, setUsername] = useState('');\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [hasSignup, setHasSignup] = useState(false);\n\n  const signup = (e) => {\n    e.preventDefault();\n    AuthService.signup(username, email, password, ['user'])\n      .then((response) => {\n        setHasSignup(true);\n      })\n      .catch((error) => {\n        setNotification({\n          status: error.name,\n          content: error.message,\n        });\n        setTimeout(() => {\n          setNotification({\n            status: null,\n            content: null,\n          });\n        }, 3000);\n      });\n  };\n  const handleNameChange = (e) => {\n    setUsername(e.target.value);\n  };\n  const handleEmailChange = (e) => {\n    setEmail(e.target.value);\n  };\n  const handlePasswordChange = (e) => {\n    setPassword(e.target.value);\n  };\n  if (hasSignup) return <Redirect to=\"login\" />;\n  console.log('process', process.env);\n  return (\n    <Box\n      title=\"Sign Up\"\n      content={\n        <Form>\n          <Form.Group controlId=\"formBasicName\">\n            <Form.Label>Username</Form.Label>\n            <Form.Control\n              type=\"text\"\n              placeholder=\"Normal text\"\n              onChange={handleNameChange}\n              value={username}\n            />\n          </Form.Group>\n          <Form.Group controlId=\"formBasicEmail\">\n            <Form.Label>Email address</Form.Label>\n            <Form.Control\n              type=\"email\"\n              placeholder=\"Enter email\"\n              onChange={handleEmailChange}\n              value={email}\n            />\n          </Form.Group>\n          <Form.Group controlId=\"formBasicPassword\">\n            <Form.Label>Password</Form.Label>\n            <Form.Control\n              type=\"password\"\n              placeholder=\"Password\"\n              onChange={handlePasswordChange}\n              value={password}\n            />\n          </Form.Group>\n        </Form>\n      }\n      control={\n        <Button onClick={signup} variant=\"primary\" type=\"submit\">\n          Sign Up\n        </Button>\n      }\n    />\n  );\n};\n\nexport default Signup;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport AuthService from '../../util/auth';\nimport './index.scss';\n\nconst Home = () => (\n  <div className=\"chat-home\">\n    <h1>Fresh Talk</h1>\n    <div className=\"chat-home__controls\">\n      <Link to=\"/signup\">Sign up</Link>\n      {AuthService.getCurrentUser() ? (\n        <Link to=\"/join\">Join</Link>\n      ) : (\n        <Link to=\"/login\">Login</Link>\n      )}\n    </div>\n  </div>\n);\n\nexport default Home;\n","import React, { useContext } from 'react';\nimport { NotificationContext } from '../../context/notification-context';\nimport './index.scss';\n\nconst Head = ({ children }) => {\n  const [notification] = useContext(NotificationContext);\n  console.log('提示', notification);\n  return (\n    <section className=\"chat__head\">\n      <div\n        className={`chat__notification chat__notification${\n          notification.status === 'Error' ? '--active' : ''\n        }`}\n      >\n        {notification.content}\n      </div>\n      <div className=\"chat__head-burgur\">{children}</div>\n    </section>\n  );\n};\n\nexport default Head;\n","import React from 'react';\nimport { Route, Redirect } from 'react-router-dom';\nimport AuthService from '../../util/auth';\n\nconst PrivateRoute = ({ component: Component, ...rest }) => (\n  <Route\n    {...rest}\n    render={(props) =>\n      AuthService.getCurrentUser() ? (\n        <Component {...props} />\n      ) : (\n        <Redirect\n          to={{\n            pathname: '/login',\n            state: { from: props.location },\n          }}\n        />\n      )\n    }\n  />\n);\n\nexport default PrivateRoute;\n","import React from 'react';\nimport { withRouter } from 'react-router-dom';\n// import { Button } from 'react-bootstrap';\nimport { BoxArrowLeft } from 'react-bootstrap-icons';\nimport './index.scss';\nimport AuthService from '../../util/auth';\n\n/**\n * withRouter will pass updated match, location,\n * and history props to the wrapped component whenever it renders.\n */\nconst AuthButton = withRouter(\n  ({ history }) =>\n    AuthService.getCurrentUser() && (\n      <BoxArrowLeft\n        size=\"30\"\n        color=\"#fff\"\n        onClick={() => {\n          AuthService.logout();\n          history.push('/');\n        }}\n      >\n        Sign out\n      </BoxArrowLeft>\n    )\n);\n\nexport default AuthButton;\n","import React from 'react';\n// import { Toast } from 'react-bootstrap';\n\nimport {\n  BrowserRouter as Router,\n  // Link,\n  Route,\n  Redirect,\n  Switch,\n  // withRouter,\n} from 'react-router-dom';\nimport { NotificationContextProvider } from '../src/context/notification-context';\nimport {\n  Home,\n  Head,\n  Login,\n  Signup,\n  AuthButton,\n  Join,\n  Chat,\n  PrivateRoute,\n} from './components';\nimport './index.scss';\n// const NotFound = () => (\n//   <div>\n//     <p>The page does not exist</p>\n//   </div>\n// );\nconst App = () => (\n  <Router>\n    <NotificationContextProvider>\n      <Head>\n        <AuthButton />\n      </Head>\n      <Switch>\n        <Route path=\"/\" exact component={Home} />\n        <Route path=\"/Signup\" component={Signup} />\n        <Route path=\"/login\" component={Login} />\n        <PrivateRoute path=\"/join\" component={Join} />\n        <PrivateRoute path=\"/chat\" component={Chat} />\n        <Redirect from=\"*\" to=\"/\" />\n      </Switch>\n    </NotificationContextProvider>\n  </Router>\n);\n\nexport default App;\n","import React from 'react';\nimport ReactDom from 'react-dom';\nimport App from './App.js';\n\nReactDom.render(<App />, document.querySelector('#root'));\n"],"sourceRoot":""}